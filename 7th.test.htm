<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ç¬¬ï¼—å›ç¢ºèªãƒ†ã‚¹ãƒˆï¼ˆå¥åº·éšœå®³1ï¼šè…«ç˜ã§ã™ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;
      line-height:1.6;color:#333;
      background:linear-gradient(135deg,#a8edea,#fed6e3);
      background-size:cover;background-repeat:no-repeat;background-attachment:fixed;
      padding:20px;margin:0;
      transition:background .3s ease,color .3s ease;
    }
    .container{max-width:800px;margin:0 auto;}
    h1,h2{font-family:'Noto Sans JP',sans-serif;font-weight:700;text-align:center;}
    .toolbar{display:flex;justify-content:flex-end;margin-bottom:12px;gap:10px;}
    .theme-toggle{
      background:linear-gradient(135deg,#111827,#1f2937);
      color:#f9fafb;border:1px solid rgba(255,255,255,0.12);
      border-radius:999px;padding:8px 14px;font-size:.95em;
      cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,0.25);
      transition:transform .2s ease,box-shadow .2s ease,background .3s ease;
    }
    .theme-toggle:hover{transform:translateY(-1px);box-shadow:0 8px 16px rgba(0,0,0,0.3);}
    .quiz-container,.result-card{
      background-color:rgba(255,255,255,0.2);
      backdrop-filter:blur(10px);
      border-radius:16px;padding:20px;margin-bottom:20px;
      border:1px solid rgba(255,255,255,0.3);
      box-shadow:0 8px 24px rgba(0,0,0,0.2);
    }
    #progress-container{width:100%;background-color:rgba(255,255,255,0.3);border-radius:10px;margin-bottom:5px;padding:4px;}
    #progress-bar{height:12px;width:0%;background:linear-gradient(135deg,#007aff,#5ac8fa);border-radius:6px;transition:width .4s ease-in-out;}
    #progress-info{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:0 5px;font-weight:bold;font-size:.9em;color:#1d1d1f;}
    .question{font-size:1.3em;margin-bottom:20px;color:#1d1d1f;}
    .options{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;}
    .option{
      background-color:rgba(255,255,255,.7);border:none;border-radius:16px;padding:15px;
      font-size:1em;cursor:pointer;position:relative;overflow:hidden;text-align:center;
      transition:background .3s ease,transform .3s ease,box-shadow .3s ease;
      box-shadow:0 4px 8px rgba(0,0,0,.1);
    }
    .option:hover{background-color:#fff;box-shadow:0 8px 16px rgba(0,0,0,.2);transform:translateY(-2px);}
    .option.selected{color:#fff;}
    .option.disabled{pointer-events:none;}
    .option.correct{background:linear-gradient(135deg,#34c759,#a8e6cf);color:#fff;}
    .option.incorrect{background:linear-gradient(135deg,#ff3b30,#ff9a8b);color:#fff;}
    .explanation{
      margin-top:20px;font-size:1em;color:#333;background-color:rgba(255,255,255,.8);
      border-left:5px solid;border-radius:12px;padding:15px;
      box-shadow:0 4px 8px rgba(0,0,0,.1);display:none;opacity:0;transition:opacity .5s ease;
    }
    .explanation-header{display:flex;align-items:center;margin-bottom:10px;font-weight:bold;}
    .explanation-icon{font-size:1.5em;margin-right:10px;}
    .nav-button{
      background:linear-gradient(135deg,#007aff,#5ac8fa);color:#fff;border:none;border-radius:12px;
      padding:12px 24px;font-size:1em;cursor:pointer;width:100%;margin-top:20px;
      transition:background .3s ease,transform .2s ease,box-shadow .3s ease,opacity .3s ease;
      box-shadow:0 4px 8px rgba(0,0,0,.1);
    }
    .nav-button:hover{background:linear-gradient(135deg,#005bb5,#4aa0d3);box-shadow:0 8px 16px rgba(0,0,0,.2);}
    .nav-button:disabled{background:linear-gradient(135deg,#c7c7cc,#d1d1d6);opacity:.6;cursor:not-allowed;box-shadow:none;transform:none;}
    .nav-button:active{transform:scale(.98);}
    .nav-button.retry-wrong{
      background:linear-gradient(135deg,#ff9500,#ff6347);
      margin-top:10px;
    }
    .nav-button.retry-wrong:hover{
      background:linear-gradient(135deg,#cc7700,#cc5039);
    }
    .result-card h3{font-size:1.2em;margin-bottom:10px;}
    .result-status{font-weight:bold;margin-bottom:10px;}
    .correct{color:#34c759;}
    .incorrect{color:#ff3b30;}
    #incorrect-summary{background-color:rgba(255,235,238,.8);border:1px solid #ff3b30;border-radius:12px;padding:15px;margin-bottom:20px;}
    #incorrect-summary h3{margin-top:0;}
    #incorrect-summary a{display:inline-block;margin:5px;padding:5px 10px;background-color:#ff3b30;color:#fff;text-decoration:none;border-radius:8px;transition:background-color .3s;}
    #incorrect-summary a:hover{background-color:#c50000;}
    #attendance-link{background-color:#34c759;color:#fff;padding:15px;border-radius:12px;margin-top:20px;text-align:center;display:none;}
    #attendance-link a{color:#fff;text-decoration:none;font-weight:bold;}

    /* ---- ãƒ¢ãƒ¼ãƒ‰ãƒãƒƒã‚¸ ---- */
    .mode-badge{
      display:inline-block;
      background:linear-gradient(135deg,#ff9500,#ff6347);
      color:#fff;
      padding:8px 16px;
      border-radius:20px;
      font-size:0.9em;
      font-weight:bold;
      margin-bottom:15px;
      box-shadow:0 4px 8px rgba(0,0,0,0.2);
    }

    /* ---- æˆç¸¾ã‚«ãƒ¼ãƒ‰ ---- */
    #summary-card{background:rgba(255,255,255,.3);border:1px solid rgba(255,255,255,.4);padding:25px;}
    .summary-grid{display:flex;align-items:center;justify-content:center;gap:30px;flex-wrap:wrap;}
    .score-display{display:grid;place-items:center;}
    @property --p{syntax:'<number>';inherits:true;initial-value:0;}
    .score-circle{
      --p:20;--b:20px;--c:#34c759;--w:180px;
      width:var(--w);aspect-ratio:1;position:relative;display:inline-grid;margin:5px;
      place-content:center;font-size:2.5em;font-weight:bold;animation:progress-load 1s .5s both;
    }
    .score-circle:before,.score-circle:after{content:"";position:absolute;border-radius:50%;}
    .score-circle:before{
      inset:0;
      background:
        radial-gradient(farthest-side,var(--c) 98%,#0000) top/var(--b) var(--b) no-repeat,
        conic-gradient(var(--c) calc(var(--p)*1%),#0000 0);
      -webkit-mask:radial-gradient(farthest-side,#0000 calc(99% - var(--b)),#000 calc(100% - var(--b)));
              mask:radial-gradient(farthest-side,#0000 calc(99% - var(--b)),#000 calc(100% - var(--b)));
    }
    .score-circle:after{inset:calc(50% - var(--b)/2);background:var(--c);transform:rotate(calc(var(--p)*3.6deg)) translateY(calc(50% - var(--w)/2));}
    @keyframes progress-load{from{--p:0;}}
    .score-percentage small{font-size:.5em;color:#555;}
    .stats-details{display:flex;flex-direction:column;gap:15px;}
    .stat-item{display:flex;align-items:center;background-color:rgba(255,255,255,.5);border-radius:12px;padding:10px 15px;}
    .stat-icon{font-size:1.5em;margin-right:12px;}
    .stat-label{font-size:.9em;color:#333;margin-right:auto;}
    .stat-value{font-size:1.2em;font-weight:bold;color:#000;}
    .feedback-message{text-align:center;margin-top:20px;font-size:1.1em;font-weight:500;padding:10px;border-radius:10px;background-color:rgba(255,255,255,.3);}

    /* ---- ã‹ã‚ã„ã„é«‘é«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ ---- */
    #skull-celebration{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      margin:30px 0;
      animation:fadeInBounce 1s ease-out;
    }
    @keyframes fadeInBounce{
      0%{opacity:0;transform:translateY(-50px) scale(0.5);}
      60%{transform:translateY(10px) scale(1.1);}
      100%{opacity:1;transform:translateY(0) scale(1);}
    }
    #skull-celebration svg{
      width:200px;
      height:200px;
      filter:drop-shadow(0 10px 20px rgba(0,0,0,0.2));
      animation:float 3s ease-in-out infinite;
    }
    @keyframes float{
      0%, 100%{transform:translateY(0px);}
      50%{transform:translateY(-15px);}
    }
    #skull-celebration .celebration-text{
      font-size:1.5em;
      font-weight:bold;
      color:#ff1493;
      margin-top:20px;
      text-shadow:2px 2px 4px rgba(0,0,0,0.2);
      animation:textGlow 2s ease-in-out infinite;
    }
    @keyframes textGlow{
      0%, 100%{text-shadow:2px 2px 4px rgba(0,0,0,0.2);}
      50%{text-shadow:0 0 20px rgba(255,20,147,0.8), 2px 2px 4px rgba(0,0,0,0.2);}
    }

    /* ---- ç´™å¹é›ªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ ---- */
    .confetti{
      position:fixed;
      width:10px;
      height:10px;
      background:#ff1493;
      top:-10px;
      animation:confetti-fall 3s linear;
      pointer-events:none;
      z-index:9999;
    }
    @keyframes confetti-fall{
      to{
        transform:translateY(100vh) rotate(360deg);
        opacity:0;
      }
    }

    /* ---- ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ ---- */
    .dark-theme{
      color:#e5e7eb;
      background:radial-gradient(ellipse at top,#1f2937 0%,#0b1220 55%,#050912 100%);
    }
    .dark-theme h1,.dark-theme h2{color:#f3f4f6;}
    .dark-theme .quiz-container,
    .dark-theme .result-card,
    .dark-theme #summary-card{background-color:rgba(17,24,39,0.55);border-color:rgba(255,255,255,0.08);box-shadow:0 10px 30px rgba(0,0,0,0.45);}
    .dark-theme #progress-container{background-color:rgba(255,255,255,0.08);}
    .dark-theme #progress-info{color:#e5e7eb;}
    .dark-theme .question{color:#f3f4f6;}
    .dark-theme .option{background-color:rgba(255,255,255,0.08);color:#e5e7eb;box-shadow:0 6px 14px rgba(0,0,0,0.25);}
    .dark-theme .option:hover{background-color:rgba(255,255,255,0.16);}
    .dark-theme .explanation{background-color:rgba(255,255,255,0.08);color:#e5e7eb;}
    .dark-theme .nav-button{background:linear-gradient(135deg,#2563eb,#1d4ed8);box-shadow:0 8px 18px rgba(0,0,0,0.35);}
    .dark-theme .nav-button:disabled{background:linear-gradient(135deg,#4b5563,#6b7280);}
    .dark-theme #incorrect-summary{background-color:rgba(255,82,82,0.08);border-color:#ff6b6b;}
    .dark-theme #incorrect-summary a{background-color:#ef4444;}
    .dark-theme #attendance-link{background-color:#22c55e;}
    .dark-theme .theme-toggle{background:linear-gradient(135deg,#fcd34d,#f59e0b);color:#111827;border-color:rgba(0,0,0,0.2);}
  </style>
</head>
<body>
  <div class="container">
    <div class="toolbar">
      <button id="theme-toggle" class="theme-toggle">ğŸŒ™ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰</button>
    </div>
    <h1>ç¬¬ï¼—å›ç¢ºèªãƒ†ã‚¹ãƒˆï¼ˆå¥åº·éšœå®³1ï¼šè…«ç˜ï¼‰</h1>

    <div id="quiz-container" class="quiz-container">
      <div id="mode-indicator"></div>
      <div id="progress-container"><div id="progress-bar"></div></div>
      <div id="progress-info">
        <div id="progress-text"></div>
        <div id="timer">00:00</div>
      </div>

      <div id="quiz-content">
        <div id="question" class="question"></div>
        <div id="options" class="options"></div>
        <div id="explanation" class="explanation"></div>
      </div>
      <button id="next" class="nav-button" disabled>æ¬¡ã®å•é¡Œ</button>
    </div>

    <div id="result-container"></div>
    <div id="attendance-link"></div>
  </div>

  <script>
    // â€”â€” ã‚¯ã‚¤ã‚ºãƒ‡ãƒ¼ã‚¿ï¼ˆè…«ç˜ï¼‰â€”â€”
    const quizData = [
  {
    "question": "è…«ç˜ã®å®šç¾©ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ç´°èƒãŒä»–å¾‹çš„ã«ä¸€æ™‚çš„ã«å¢—æ®–ã™ã‚‹",
      "ç´°èƒãŒè‡ªå¾‹çš„ã«éå‰°ã«å¢—æ®–ã—ã€å˜ã‚¯ãƒ­ãƒ¼ãƒ³æ€§ã§ã‚ã‚‹",
      "ç´°èƒãŒç‚ç—‡åå¿œã«ã‚ˆã‚Šå¢—æ®–ã™ã‚‹",
      "ç´°èƒãŒå†ç”Ÿéç¨‹ã§å¢—æ®–ã™ã‚‹"
    ],
    "answer": 1,
    "explanation": "è…«ç˜ã¨ã¯ã€ç´°èƒãŒè‡ªå¾‹çš„ã«(å¤–éƒ¨ã‚·ã‚°ãƒŠãƒ«ã«ä¾å­˜ã›ãš)éå‰°ã«å¢—æ®–ã—ã€ã‹ã¤å˜ä¸€ã®ç´°èƒã«ç”±æ¥ã™ã‚‹(å˜ã‚¯ãƒ­ãƒ¼ãƒ³æ€§)ç—…å¤‰ã§ã™ã€‚ç‚ç—‡ã‚„å‰µå‚·æ²»ç™’ã«ãŠã‘ã‚‹ç´°èƒå¢—æ®–ã¯ä»–å¾‹æ€§ã§ä¸€æ™‚çš„ãªã‚‚ã®ã§ã™ã€‚"
  },
  {
    "question": "æ‚ªæ€§è…«ç˜ç´°èƒã®ç´°èƒç•°å‹ã¨ã—ã¦æ­£ã—ããªã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ç´°èƒã®å¤§å‹åŒ–",
      "æ ¸ã®ç¸®å°ã¨N/Cæ¯”ã®æ¸›å°‘",
      "æ ¸å°ä½“ã®å¢—åŠ ",
      "ç•°å¸¸ãªæ ¸åˆ†è£‚åƒ"
    ],
    "answer": 1,
    "explanation": "æ‚ªæ€§è…«ç˜ç´°èƒã§ã¯æ ¸ãŒå¢—å¤§ã—ã€N/Cæ¯”(æ ¸/ç´°èƒè³ªæ¯”)ãŒå¢—åŠ ã—ã¾ã™ã€‚æ ¸ã®ç¸®å°ã¨N/Cæ¯”ã®æ¸›å°‘ã¯ç´°èƒç•°å‹ã®ç‰¹å¾´ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãã®ä»–ã®é¸æŠè‚¢ã¯ã™ã¹ã¦æ‚ªæ€§è…«ç˜ç´°èƒã®å…¸å‹çš„ãªç‰¹å¾´ã§ã™ã€‚"
  },
  {
    "question": "ãŒã‚“ã®åˆ†åŒ–åº¦ã«ã¤ã„ã¦æ­£ã—ã„è¨˜è¿°ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ä½åˆ†åŒ–ãŒã‚“ã¯æ­£å¸¸çµ„ç¹”ã«ã‚ˆãä¼¼ã¦ã„ã‚‹",
      "é«˜åˆ†åŒ–ãŒã‚“ã¯ç™ºç”Ÿæ¯åœ°ã¨ã®é•ã„ãŒå¤§ãã„",
      "ä½åˆ†åŒ–ãŒã‚“ã»ã©ä¸€èˆ¬ã«æ‚ªæ€§åº¦ãŒé«˜ã„",
      "åˆ†åŒ–åº¦ã¯äºˆå¾Œã¨é–¢ä¿‚ãŒãªã„"
    ],
    "answer": 2,
    "explanation": "ä½åˆ†åŒ–ãŒã‚“ã¯æ­£å¸¸çµ„ç¹”ã¨ã®é•ã„ãŒå¤§ããã€ç´°èƒç•°å‹ãŒå¼·ãã€ä¸€èˆ¬ã«æ‚ªæ€§åº¦ãŒé«˜ãäºˆå¾Œä¸è‰¯ã§ã™ã€‚é«˜åˆ†åŒ–ãŒã‚“ã¯ç™ºç”Ÿæ¯åœ°ã«ã‚ˆãä¼¼ã¦ãŠã‚Šã€æ¯”è¼ƒçš„äºˆå¾Œè‰¯å¥½ã§ã™ã€‚åˆ†åŒ–åº¦ã¯æ²»ç™‚æ–¹é‡ã‚„äºˆå¾Œåˆ¤å®šã®é‡è¦ãªæŒ‡æ¨™ã§ã™ã€‚"
  },
  {
    "question": "è‰¯æ€§è…«ç˜ã®ç‰¹å¾´ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "å¢—æ®–é€Ÿåº¦ãŒé€Ÿãæµ¸æ½¤æ€§ã«ç™ºè‚²ã™ã‚‹",
      "é éš”è»¢ç§»ã‚’èµ·ã“ã™",
      "è¢«è†œã«åŒ…ã¾ã‚Œè†¨å¼µæ€§ç™ºè‚²ã‚’ç¤ºã™",
      "ç´°èƒç•°å‹ãŒè‘—æ˜ã§ã‚ã‚‹"
    ],
    "answer": 2,
    "explanation": "è‰¯æ€§è…«ç˜ã¯å¢—æ®–é€Ÿåº¦ãŒé…ãã€è¢«è†œã«åŒ…ã¾ã‚Œã¦è†¨å¼µæ€§ç™ºè‚²ã‚’ç¤ºã—ã€å‘¨å›²çµ„ç¹”ã‚’åœ§æ’ã—ã¾ã™ãŒæµ¸æ½¤ã‚„è»¢ç§»ã¯ã—ã¾ã›ã‚“ã€‚ç´°èƒç•°å‹ã‚‚è»½åº¦ã§ã™ã€‚å®Œå…¨åˆ‡é™¤ã§ãã‚Œã°å†ç™ºã—ã¾ã›ã‚“ã€‚"
  },
  {
    "question": "ä¸Šçš®æ€§æ‚ªæ€§è…«ç˜ã®åç§°ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "è„‚è‚ªè‚‰è…«",
      "è…ºç™Œ",
      "å¹³æ»‘ç­‹è…«",
      "éª¨è‚‰è…«"
    ],
    "answer": 1,
    "explanation": "ä¸Šçš®æ€§æ‚ªæ€§è…«ç˜ã¯ã€Œã€œç™Œ(ãŒã‚“)ã€ã¨å‘½åã•ã‚Œã¾ã™ã€‚è…ºç™Œã¯è…ºä¸Šçš®ç”±æ¥ã®æ‚ªæ€§è…«ç˜ã§ã™ã€‚è„‚è‚ªè‚‰è…«ã‚„éª¨è‚‰è…«ã¯éä¸Šçš®æ€§æ‚ªæ€§è…«ç˜(è‚‰è…«)ã€å¹³æ»‘ç­‹è…«ã¯éä¸Šçš®æ€§è‰¯æ€§è…«ç˜ã§ã™ã€‚"
  },
  {
    "question": "ç™Œè…«ã¨è‚‰è…«ã®é•ã„ã«ã¤ã„ã¦æ­£ã—ã„è¨˜è¿°ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ç™Œè…«ã¯è¡€è¡Œæ€§è»¢ç§»ãŒä¸»ä½“ã§ã‚ã‚‹",
      "è‚‰è…«ã¯æˆäººã«åœ§å€’çš„ã«å¤šã„",
      "ç™Œè…«ã¯ãƒªãƒ³ãƒ‘è¡Œæ€§è»¢ç§»ãŒä¸»ä½“ã§ã‚ã‚‹",
      "è‚‰è…«ã¯å…¨æ‚ªæ€§è…«ç˜ã®ç´„90%ã‚’å ã‚ã‚‹"
    ],
    "answer": 2,
    "explanation": "ç™Œè…«(ä¸Šçš®æ€§æ‚ªæ€§è…«ç˜)ã¯ãƒªãƒ³ãƒ‘è¡Œæ€§è»¢ç§»ãŒä¸»ä½“ã§ã€æˆäººã«å¤šãã€å…¨æ‚ªæ€§è…«ç˜ã®ç´„90%ã‚’å ã‚ã¾ã™ã€‚è‚‰è…«(éä¸Šçš®æ€§æ‚ªæ€§è…«ç˜)ã¯è¡€è¡Œæ€§è»¢ç§»ãŒä¸»ä½“ã§ã€å°å…æœŸã«ã‚‚ç™ºç”Ÿã—ã€æ¯”è¼ƒçš„ã¾ã‚Œã§ã™ã€‚"
  },
  {
    "question": "èƒƒã®è…ºçµ„ç¹”ã‹ã‚‰ç™ºç”Ÿã—ãŸæ‚ªæ€§è…«ç˜ã®æ­£ã—ã„åç§°ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "èƒƒè‚‰è…«",
      "èƒƒè…ºè…«",
      "èƒƒè…ºç™Œ",
      "èƒƒå¹³æ»‘ç­‹è…«"
    ],
    "answer": 2,
    "explanation": "è…ºçµ„ç¹”ç”±æ¥ã®æ‚ªæ€§è…«ç˜ã¯ã€Œè…ºç™Œã€ã¨å‘½åã•ã‚Œã¾ã™ã€‚èƒƒã®è…ºçµ„ç¹”ç”±æ¥ãªã‚‰ã€Œèƒƒè…ºç™Œã€ã§ã™ã€‚è…ºè…«ã¯è‰¯æ€§ã€è‚‰è…«ã¯éä¸Šçš®æ€§æ‚ªæ€§è…«ç˜ã€å¹³æ»‘ç­‹è…«ã¯ç­‹çµ„ç¹”ç”±æ¥ã®è‰¯æ€§è…«ç˜ã§ã™ã€‚"
  },
  {
    "question": "ãŒã‚“ã®æœ¬è³ªã«ã¤ã„ã¦æ­£ã—ã„è¨˜è¿°ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ç´”ç²‹ã«ç’°å¢ƒè¦å› ã®ã¿ã§ç™ºç”Ÿã™ã‚‹",
      "éºä¼çš„ç´ å› ã¨å¤–å› ã«ã‚ˆã‚‹éºä¼å­ã®ç—…æ°—",
      "æ„ŸæŸ“ç—‡ã®ã¿ãŒåŸå› ã§ã‚ã‚‹",
      "åŠ é½¢ã®ã¿ã§å¿…ãšç™ºç”Ÿã™ã‚‹"
    ],
    "answer": 1,
    "explanation": "ãŒã‚“ã¯ã€Œéºä¼çš„ç´ å› ã¨å¤–å› ã«ã‚ˆã‚‹éºä¼å­ã®ç—…æ°—ã€ã§ã™ã€‚ç”Ÿã¾ã‚ŒæŒã£ãŸéºä¼çš„èƒŒæ™¯ã¨ã€ç’°å¢ƒè¦å› ã‚„ç”Ÿæ´»ç¿’æ…£ãªã©ã®å¤–å› ãŒçµ„ã¿åˆã‚ã•ã£ã¦ã€ç´°èƒã®éºä¼å­ã«ç•°å¸¸ãŒè“„ç©ã™ã‚‹ã“ã¨ã§ç™ºç”Ÿã—ã¾ã™ã€‚"
  },
  {
    "question": "åŸãŒã‚“éºä¼å­ã«ã¤ã„ã¦æ­£ã—ã„è¨˜è¿°ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "æ­£å¸¸çŠ¶æ…‹ã§ã¯ç´°èƒå¢—æ®–ã‚„åˆ†åŒ–ã«å¿…è¦ãªéºä¼å­ã§ã‚ã‚‹",
      "ç”Ÿã¾ã‚Œã¤ãç•°å¸¸ãªéºä¼å­ã§ã‚ã‚‹",
      "ã™ã¹ã¦ã®äººãŒæŒã£ã¦ã„ãªã„ç‰¹æ®Šãªéºä¼å­ã§ã‚ã‚‹",
      "ç´°èƒå¢—æ®–ã‚’å¸¸ã«æŠ‘åˆ¶ã™ã‚‹éºä¼å­ã§ã‚ã‚‹"
    ],
    "answer": 0,
    "explanation": "åŸãŒã‚“éºä¼å­ã¯ã€æ­£å¸¸çŠ¶æ…‹ã§ã¯ç´°èƒå¢—æ®–ã€åˆ†åŒ–ã€ç”Ÿå­˜ã«å¿…è¦ãªéºä¼å­ã§ã™ã€‚ã™ã¹ã¦ã®äººãŒæŒã£ã¦ã„ã¾ã™ã€‚å¤‰ç•°ã‚„éå‰°ç™ºç¾ã«ã‚ˆã‚Šã€ŒãŒã‚“éºä¼å­ã€ã¨ãªã‚Šã€ç´°èƒå¢—æ®–ãŒæš´èµ°ã—ã¾ã™ã€‚"
  },
  {
    "question": "åŸãŒã‚“éºä¼å­ãŒãŒã‚“éºä¼å­ã«ãªã‚‹ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨ã—ã¦æ­£ã—ããªã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ç‚¹å¤‰ç•°",
      "éºä¼å­å¢—å¹…",
      "æŸ“è‰²ä½“è»¢åº§",
      "éºä¼å­ã®å®Œå…¨æ¬ å¤±"
    ],
    "answer": 3,
    "explanation": "åŸãŒã‚“éºä¼å­ãŒãŒã‚“éºä¼å­åŒ–ã™ã‚‹ä¸»ãªãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã€ç‚¹å¤‰ç•°(éºä¼å­ã®ä¸€éƒ¨å¤‰ç•°)ã€éºä¼å­å¢—å¹…(ã‚³ãƒ”ãƒ¼æ•°å¢—åŠ )ã€æŸ“è‰²ä½“è»¢åº§(éºä¼å­ã®ä½ç½®ç•°å¸¸)ã§ã™ã€‚å®Œå…¨æ¬ å¤±ã¯æ©Ÿèƒ½å–ªå¤±ã‚’æ„å‘³ã—ã€ãŒã‚“æŠ‘åˆ¶éºä¼å­ã®ä¸æ´»åŒ–ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã§ã™ã€‚"
  },
  {
    "question": "ãŒã‚“æŠ‘åˆ¶éºä¼å­ã®å½¹å‰²ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ç´°èƒå¢—æ®–ã‚’ä¿ƒé€²ã™ã‚‹",
      "ç´°èƒå¢—æ®–ã‚’æŠ‘åˆ¶ã—ã€DNAä¿®å¾©ã‚„ç´°èƒæ­»ã‚’èª˜å°ã™ã‚‹",
      "ãŒã‚“éºä¼å­ã‚’æ´»æ€§åŒ–ã™ã‚‹",
      "å¸¸ã«ç´°èƒã‚’åˆ†è£‚ã•ã›ã‚‹"
    ],
    "answer": 1,
    "explanation": "ãŒã‚“æŠ‘åˆ¶éºä¼å­ã¯ç´°èƒå¢—æ®–ã®ãƒ–ãƒ¬ãƒ¼ã‚­ã¨ã—ã¦åƒãã€ç´°èƒå‘¨æœŸã®é€²è¡Œã‚’æŠ‘åˆ¶ã—ãŸã‚Šã€DNAæå‚·ã‚’ä¿®å¾©ã—ãŸã‚Šã€ä¿®å¾©ä¸èƒ½ãªå ´åˆã«ã¯ç´°èƒæ­»(ã‚¢ãƒãƒˆãƒ¼ã‚·ã‚¹)ã‚’èª˜å°ã—ã¾ã™ã€‚"
  },
  {
    "question": "p53éºä¼å­ã«ã¤ã„ã¦æ­£ã—ã„è¨˜è¿°ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ãŒã‚“éºä¼å­ã®ä»£è¡¨ä¾‹ã§ã‚ã‚‹",
      "ã‚²ãƒãƒ ã®å®ˆè­·ç¥ã¨å‘¼ã°ã‚Œã‚‹é‡è¦ãªãŒã‚“æŠ‘åˆ¶éºä¼å­ã§ã‚ã‚‹",
      "äººã®ãŒã‚“ã§ã¯ã»ã¨ã‚“ã©å¤‰ç•°ã—ãªã„",
      "DNAæå‚·æ™‚ã«ç´°èƒå¢—æ®–ã‚’ä¿ƒé€²ã™ã‚‹"
    ],
    "answer": 1,
    "explanation": "p53ã¯ã€Œã‚²ãƒãƒ ã®å®ˆè­·ç¥ã€ã¨å‘¼ã°ã‚Œã‚‹æœ€ã‚‚é‡è¦ãªãŒã‚“æŠ‘åˆ¶éºä¼å­ã§ã™ã€‚DNAæå‚·æ™‚ã«ç´°èƒå‘¨æœŸã‚’åœæ­¢ã•ã›ã€ä¿®å¾©ã‚’ä¿ƒã—ã€ä¿®å¾©ä¸èƒ½ãªã‚‰ç´°èƒæ­»ã‚’èª˜å°ã—ã¾ã™ã€‚äººã®ãŒã‚“ã®ç´„50%ã§å¤‰ç•°ã—ã¦ã„ã¾ã™ã€‚"
  },
  {
    "question": "å¤šæ®µéšç™ºãŒã‚“ã«ã¤ã„ã¦æ­£ã—ã„è¨˜è¿°ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "1ã¤ã®éºä¼å­ç•°å¸¸ã§å³åº§ã«ãŒã‚“ãŒç™ºç”Ÿã™ã‚‹",
      "è¤‡æ•°ã®éºä¼å­ç•°å¸¸ãŒæ®µéšçš„ã«è“„ç©ã—ã¦ãŒã‚“ãŒç™ºç”Ÿã™ã‚‹",
      "ç’°å¢ƒè¦å› ã®ã¿ã§ãŒã‚“ãŒç™ºç”Ÿã™ã‚‹",
      "éºä¼çš„è¦å› ã¯é–¢ä¿‚ãªã„"
    ],
    "answer": 1,
    "explanation": "ãŒã‚“ã¯è¤‡æ•°ã®éºä¼å­ç•°å¸¸(ãŒã‚“éºä¼å­ã®æ´»æ€§åŒ–ã¨ãŒã‚“æŠ‘åˆ¶éºä¼å­ã®ä¸æ´»åŒ–)ãŒæ®µéšçš„ã«è“„ç©ã™ã‚‹ã“ã¨ã§ã€æ­£å¸¸ç´°èƒã‹ã‚‰æ‚ªæ€§ãŒã‚“ã¸ã¨å¤‰åŒ–ã—ã¾ã™ã€‚ã“ã®éç¨‹ã«ã¯é€šå¸¸æ•°å¹´ã‹ã‚‰æ•°åå¹´ã‹ã‹ã‚Šã¾ã™ã€‚"
  },
  {
    "question": "å¤§è…¸ãŒã‚“ã®å¤šæ®µéšç™ºãŒã‚“éç¨‹ã§æœ€åˆã«å¤‰ç•°ã™ã‚‹éºä¼å­ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "p53éºä¼å­",
      "APCéºä¼å­",
      "K-RASéºä¼å­",
      "BRCA1éºä¼å­"
    ],
    "answer": 1,
    "explanation": "å®¶æ—æ€§å¤§è…¸ãƒãƒªãƒãƒ¼ã‚·ã‚¹ã‚„æ•£ç™ºæ€§å¤§è…¸ãŒã‚“ã®ç™ºç”Ÿéç¨‹ã§ã¯ã€APCéºä¼å­ã®å¤‰ç•°ãŒæœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦è…ºè…«ã‚’å½¢æˆã—ã¾ã™ã€‚ãã®å¾ŒK-RASã€p53ãªã©ã®å¤‰ç•°ãŒé †æ¬¡è“„ç©ã—ã€ãŒã‚“ã¸ã¨é€²å±•ã—ã¾ã™ã€‚"
  },
  {
    "question": "æ—¥æœ¬äººç”·æ€§ã«ãŠã‘ã‚‹ãŒã‚“ã®æœ€å¤§ã®ç™ºç”Ÿè¦å› ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "é£²é…’",
      "å–«ç…™",
      "é‹å‹•ä¸è¶³",
      "ã‚¹ãƒˆãƒ¬ã‚¹"
    ],
    "answer": 1,
    "explanation": "æ—¥æœ¬äººç”·æ€§ã«ãŠã„ã¦ã€å–«ç…™ã¯ãŒã‚“ã®æœ€å¤§ã®ç™ºç”Ÿè¦å› ã§ã€ç´„30%è¿‘ãã‚’å ã‚ã¾ã™ã€‚ã‚¿ãƒã‚³ã®ç…™ã«ã¯ç´„70ç¨®é¡ã®ç™ºãŒã‚“æ€§ç‰©è³ªãŒå«ã¾ã‚Œã€è‚ºãŒã‚“ã ã‘ã§ãªãå¤šãã®ãŒã‚“ã®ãƒªã‚¹ã‚¯ã‚’ä¸Šæ˜‡ã•ã›ã¾ã™ã€‚"
  },
  {
    "question": "æ…¢æ€§æ„ŸæŸ“ã«èµ·å› ã™ã‚‹ãŒã‚“ã®çµ„ã¿åˆã‚ã›ã¨ã—ã¦æ­£ã—ããªã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "Bå‹è‚ç‚ã‚¦ã‚¤ãƒ«ã‚¹ - è‚ç´°èƒãŒã‚“",
      "ãƒ˜ãƒªã‚³ãƒã‚¯ã‚¿ãƒ¼ãƒ»ãƒ”ãƒ­ãƒªèŒ - èƒƒãŒã‚“",
      "ãƒ’ãƒˆãƒ‘ãƒ”ãƒ­ãƒ¼ãƒã‚¦ã‚¤ãƒ«ã‚¹(HPV) - å­å®®é ¸ãŒã‚“",
      "ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶ã‚¦ã‚¤ãƒ«ã‚¹ - è‚ºãŒã‚“"
    ],
    "answer": 3,
    "explanation": "Bå‹ãƒ»Cå‹è‚ç‚ã‚¦ã‚¤ãƒ«ã‚¹ã¯è‚ç´°èƒãŒã‚“ã€ãƒ”ãƒ­ãƒªèŒã¯èƒƒãŒã‚“ã€HPVã¯å­å®®é ¸ãŒã‚“ã®åŸå› ã¨ãªã‚Šã¾ã™ã€‚ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶ã‚¦ã‚¤ãƒ«ã‚¹ã¯æ€¥æ€§æ„ŸæŸ“ç—‡ã®åŸå› ã§ã™ãŒã€ãŒã‚“ã¨ã®é–¢é€£ã¯ç¢ºç«‹ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
  },
  {
    "question": "æ‚ªæ€§è…«ç˜ã®é éš”è»¢ç§»ã®çµŒè·¯ã¨ã—ã¦æ­£ã—ããªã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "ãƒªãƒ³ãƒ‘è¡Œæ€§è»¢ç§»",
      "è¡€è¡Œæ€§è»¢ç§»",
      "æ’­ç¨®æ€§è»¢ç§»",
      "ç¥çµŒæ€§è»¢ç§»"
    ],
    "answer": 3,
    "explanation": "æ‚ªæ€§è…«ç˜ã®é éš”è»¢ç§»ã®çµŒè·¯ã¯ã€â‘ ãƒªãƒ³ãƒ‘è¡Œæ€§è»¢ç§»(ãƒªãƒ³ãƒ‘ç®¡çµŒç”±)ã€â‘¡è¡€è¡Œæ€§è»¢ç§»(è¡€ç®¡çµŒç”±)ã€â‘¢æ’­ç¨®æ€§è»¢ç§»(ä½“è…”å†…æ•£å¸ƒ)ã®3ã¤ã§ã™ã€‚ç¥çµŒæ€§è»¢ç§»ã¨ã„ã†çµŒè·¯ã¯ä¸€èˆ¬çš„ã«ã¯èªã‚ã‚‰ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
  },
  {
    "question": "ä¸Šçš®å†…ãŒã‚“ã«ã¤ã„ã¦æ­£ã—ã„è¨˜è¿°ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "æ—¢ã«é éš”è»¢ç§»ãŒã‚ã‚‹çŠ¶æ…‹",
      "åŸºåº•è†œã‚’ç ´ã£ã¦æµ¸æ½¤ã—ã¦ã„ã‚‹çŠ¶æ…‹",
      "ãŒã‚“ç´°èƒãŒä¸Šçš®å†…ã«ã¨ã©ã¾ã‚ŠåŸºåº•è†œã‚’ç ´ã£ã¦ã„ãªã„çŠ¶æ…‹",
      "æ²»ç™‚ä¸å¯èƒ½ãªé€²è¡ŒãŒã‚“"
    ],
    "answer": 2,
    "explanation": "ä¸Šçš®å†…ãŒã‚“ã¯ã€ãŒã‚“ç´°èƒãŒä¸Šçš®å†…ã«ã¨ã©ã¾ã‚ŠåŸºåº•è†œã‚’ç ´ã£ã¦ã„ãªã„çŠ¶æ…‹ã§ã™ã€‚ç†è«–çš„ã«ã¯è»¢ç§»ã®å¯èƒ½æ€§ãŒãªãã€å®Œå…¨åˆ‡é™¤ã§ãã‚Œã°ã»ã¼100%æ²»ç™’ã—ã¾ã™ã€‚æ—©æœŸãŒã‚“ã¨ã»ã¼åŒç¾©ã§ã™ã€‚"
  },
  {
    "question": "èƒƒãŒã‚“ã®æ·±é”åº¦åˆ†é¡ã§æ—©æœŸãŒã‚“ã«å«ã¾ã‚Œã‚‹ã®ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "æ¼¿è†œã¾ã§æµ¸æ½¤ã—ãŸãŒã‚“",
      "ç²˜è†œä¸‹å±¤ã¾ã§ã®æµ¸æ½¤ã«ã¨ã©ã¾ã‚‹ãŒã‚“",
      "å›ºæœ‰ç­‹å±¤ã«æµ¸æ½¤ã—ãŸãŒã‚“",
      "ä»–è‡“å™¨ã«æµ¸æ½¤ã—ãŸãŒã‚“"
    ],
    "answer": 1,
    "explanation": "èƒƒãŒã‚“ã§ã¯ã€æµ¸æ½¤ãŒç²˜è†œä¸‹å±¤ã¾ã§ã«ã¨ã©ã¾ã‚‹ã‚‚ã®(T1a, T1b)ã‚’æ—©æœŸãŒã‚“ã¨å®šç¾©ã—ã¾ã™ã€‚å›ºæœ‰ç­‹å±¤ä»¥æ·±ã«æµ¸æ½¤ã™ã‚‹ã¨é€²è¡ŒãŒã‚“ã¨ãªã‚Šã¾ã™ã€‚æ·±é”åº¦ãŒæ·±ã„ã»ã©è»¢ç§»ãƒªã‚¹ã‚¯ã¨äºˆå¾Œä¸è‰¯ã®ãƒªã‚¹ã‚¯ãŒé«˜ã¾ã‚Šã¾ã™ã€‚"
  },
  {
    "question": "æ¶ˆåŒ–ç®¡ãŒã‚“ãŒè¡€è¡Œæ€§è»¢ç§»ã‚’èµ·ã“ã™å ´åˆã€æœ€åˆã«è»¢ç§»ã—ã‚„ã™ã„è‡“å™¨ã¯ã©ã‚Œã§ã™ã‹?",
    "options": [
      "è„³",
      "è‚º",
      "è‚è‡“",
      "éª¨"
    ],
    "answer": 2,
    "explanation": "æ¶ˆåŒ–ç®¡ãŒã‚“ã¯é–€è„ˆã‚’çµŒç”±ã™ã‚‹ãŸã‚ã€ã¾ãšè‚è‡“ã«è¡€è¡Œæ€§è»¢ç§»ã—ã‚„ã™ã„ã§ã™ã€‚è‚è‡“ã‚’é€šéã—ãŸè¡€æ¶²ã¯å¿ƒè‡“ã‚’çµŒã¦è‚ºã«è‡³ã‚‹ãŸã‚ã€æ¬¡ã«è‚ºè»¢ç§»ãŒèµ·ã“ã‚Šã¾ã™ã€‚è„³ã‚„éª¨ã¸ã®è»¢ç§»ã¯ã•ã‚‰ã«å¾Œã®æ®µéšã§ã™ã€‚"
  }
];

    // â€”â€” ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ â€”â€” 
    const $ = (id) => document.getElementById(id);
    function shuffle(array){
      for(let i=array.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [array[i],array[j]] = [array[j],array[i]];
      }
      return array;
    }

    // â€”â€” ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ â€”â€” 
    const themeToggle = $('theme-toggle');
    function applyTheme(mode){
      const isDark = (mode === 'dark');
      document.body.classList.toggle('dark-theme', isDark);
      if(themeToggle){
        themeToggle.textContent = isDark ? 'â˜€ï¸ ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰' : 'ğŸŒ™ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰';
      }
      localStorage.setItem('quiz-theme', isDark ? 'dark' : 'light');
    }
    function initTheme(){
      const saved = localStorage.getItem('quiz-theme');
      applyTheme(saved === 'dark' ? 'dark' : 'light');
      if(themeToggle){
        themeToggle.addEventListener('click', ()=>{
          const next = document.body.classList.contains('dark-theme') ? 'light' : 'dark';
          applyTheme(next);
        });
      }
    }

    // â€”â€” ç´™å¹é›ªã‚¨ãƒ•ã‚§ã‚¯ãƒˆ â€”â€” 
    function createConfetti(){
      const colors = ['#ff1493','#00bfff','#ffd700','#ff6347','#98fb98','#dda0dd'];
      for(let i=0;i<50;i++){
        setTimeout(()=>{
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random()*100 + '%';
          confetti.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
          confetti.style.animationDuration = (Math.random()*2 + 2) + 's';
          confetti.style.animationDelay = Math.random()*0.5 + 's';
          document.body.appendChild(confetti);
          setTimeout(()=> confetti.remove(), 4000);
        }, i*50);
      }
    }

    // â€”â€” ãƒ”ã‚«ãƒãƒ¥ã‚¦é¢¨ã‚­ãƒ£ãƒ©SVGã‚’ç”Ÿæˆ â€”â€” 
    function createSkullSVG(){
      return `
        <svg viewBox="0 0 220 220" xmlns="http://www.w3.org/2000/svg">
          <!-- ä½“ -->
          <defs>
            <linearGradient id="pika-body" x1="0%" x2="0%" y1="0%" y2="100%">
              <stop offset="0%" stop-color="#ffe066"/>
              <stop offset="100%" stop-color="#ffcc33"/>
            </linearGradient>
          </defs>
          <ellipse cx="110" cy="125" rx="70" ry="75" fill="url(#pika-body)" stroke="#e2a100" stroke-width="3"/>

          <!-- è€³ -->
          <path d="M70 48 C60 10, 30 10, 30 45 C35 65,55 75,70 70 Z" fill="#ffe066" stroke="#e2a100" stroke-width="3"/>
          <path d="M70 20 L55 35 L70 55 Z" fill="#1c1c1c"/>
          <path d="M150 48 C160 10, 190 10, 190 45 C185 65,165 75,150 70 Z" fill="#ffe066" stroke="#e2a100" stroke-width="3"/>
          <path d="M150 20 L165 35 L150 55 Z" fill="#1c1c1c"/>

          <!-- å°»å°¾ -->
          <path d="M170 130 L210 130 L185 150 L205 150 L165 185 L170 155 L150 155 Z" fill="#ffcc33" stroke="#cc9800" stroke-width="4" stroke-linejoin="round"/>

          <!-- è…•ãƒ»è¶³ -->
          <ellipse cx="60" cy="140" rx="22" ry="16" fill="#ffd54f" stroke="#e2a100" stroke-width="3"/>
          <ellipse cx="160" cy="140" rx="22" ry="16" fill="#ffd54f" stroke="#e2a100" stroke-width="3"/>
          <ellipse cx="85" cy="190" rx="22" ry="14" fill="#ffcc33" stroke="#e2a100" stroke-width="3"/>
          <ellipse cx="135" cy="190" rx="22" ry="14" fill="#ffcc33" stroke="#e2a100" stroke-width="3"/>

          <!-- é¡” -->
          <ellipse cx="90" cy="110" rx="12" ry="14" fill="#1c1c1c"/>
          <ellipse cx="130" cy="110" rx="12" ry="14" fill="#1c1c1c"/>
          <circle cx="95" cy="105" r="4" fill="#fff" opacity="0.7"/>
          <circle cx="135" cy="105" r="4" fill="#fff" opacity="0.7"/>
          <path d="M108 118 L112 118 L110 125 Z" fill="#1c1c1c"/>
          <path d="M90 140 Q110 150 130 140" fill="none" stroke="#1c1c1c" stroke-width="4" stroke-linecap="round"/>

          <!-- ã»ã£ãº -->
          <ellipse cx="70" cy="130" rx="14" ry="12" fill="#ff6b6b" opacity="0.85"/>
          <ellipse cx="150" cy="130" rx="14" ry="12" fill="#ff6b6b" opacity="0.85"/>

          <!-- ç¨²å¦»ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ -->
          <g opacity="0.6">
            <path d="M40 70 L65 65 L55 90 L75 85 L45 120 L55 95 L35 100 Z" fill="#ffd700" stroke="#ffae00" stroke-width="2">
              <animateTransform attributeName="transform" type="rotate" from="0 55 90" to="-8 55 90" dur="1.2s" repeatCount="indefinite" />
            </path>
            <path d="M180 70 L155 65 L165 90 L145 85 L175 120 L165 95 L185 100 Z" fill="#ffd700" stroke="#ffae00" stroke-width="2">
              <animateTransform attributeName="transform" type="rotate" from="0 165 90" to="8 165 90" dur="1.2s" repeatCount="indefinite" />
            </path>
          </g>
        </svg>
      `;
    }

    // â€”â€” çŠ¶æ…‹ â€”â€” 
    let current = 0, score = 0, userAnswers = [];
    let order = [];        // å…¨è¨­å•ã®ä¸¦ã³
    let optionOrder = [];  // å„è¨­å•ã”ã¨ã®é¸æŠè‚¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä¸¦ã³
    let timer = null, seconds = 0;
    let isRetryMode = false; // é–“é•ã„ç›´ã—ãƒ¢ãƒ¼ãƒ‰ãƒ•ãƒ©ã‚°
    let wrongQuestions = []; // é–“é•ãˆãŸå•é¡Œã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒªã‚¹ãƒˆ
    let retryHistory = {}; // å„å•é¡Œã®å¾©ç¿’å±¥æ­´ã‚’ä¿å­˜

    function startTimer(){
      if(timer) clearInterval(timer);
      seconds = 0; $('timer').textContent = '00:00';
      timer = setInterval(()=>{
        seconds++;
        const m = String(Math.floor(seconds/60)).padStart(2,'0');
        const s = String(seconds%60).padStart(2,'0');
        $('timer').textContent = `${m}:${s}`;
      },1000);
    }

    function initQuiz(retryMode = false, retryQuestions = []){
      isRetryMode = retryMode;
      
      if(isRetryMode){
        // é–“é•ã„ç›´ã—ãƒ¢ãƒ¼ãƒ‰
        order = shuffle([...retryQuestions]);
        $('mode-indicator').innerHTML = '<div class="mode-badge">ğŸ”„ é–“é•ã„ç›´ã—ãƒ¢ãƒ¼ãƒ‰</div>';
      } else {
        // é€šå¸¸ãƒ¢ãƒ¼ãƒ‰
        order = shuffle([...Array(quizData.length).keys()]);
        $('mode-indicator').innerHTML = '';
        retryHistory = {}; // å±¥æ­´ãƒªã‚»ãƒƒãƒˆ
      }
      
      // å„è¨­å•ã®é¸æŠè‚¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
      optionOrder = order.map(qi => shuffle([0,1,2,3]));
      userAnswers = Array(quizData.length).fill(null);
      current = 0; score = 0;
      startTimer();
      renderQuestion();
    }

    function renderQuestion(){
      const qIndex = order[current];
      const q = quizData[qIndex];

      // é€²æ—
      const prog = ((current+1)/order.length)*100;
      $('progress-bar').style.width = `${prog}%`;
      $('progress-text').textContent = `${current+1} / ${order.length} å•`;

      // æœ¬æ–‡
      $('question').textContent = q.question;

      // é¸æŠè‚¢ï¼ˆindexã§å®‰å…¨ã«ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼‰
      const idxOrder = optionOrder[current];
      $('options').innerHTML = idxOrder.map((optIdx,i)=>(
        `<button class="option" data-opt="${optIdx}" onclick="selectOption(${optIdx}, this)">${q.options[optIdx]}</button>`
      )).join('');

      // è§£èª¬ãƒªã‚»ãƒƒãƒˆ
      const exp = $('explanation');
      exp.style.display='none'; exp.style.opacity='0'; exp.innerHTML='';
      $('next').disabled = true;
    }

    window.selectOption = function(originalOptionIndex, el){
      // å…¨ã¦ç„¡åŠ¹åŒ–
      document.querySelectorAll('.option').forEach(o=>o.classList.add('disabled'));
      el.classList.add('selected');

      const qIndex = order[current];
      const q = quizData[qIndex];
      const isCorrect = (originalOptionIndex === q.answer);
      userAnswers[qIndex] = originalOptionIndex;
      
      // å¾©ç¿’å±¥æ­´ã‚’è¨˜éŒ²
      if(isRetryMode){
        if(!retryHistory[qIndex]) retryHistory[qIndex] = [];
        retryHistory[qIndex].push(isCorrect);
      }
      
      if(isCorrect){ el.classList.add('correct'); score++; }
      else{
        el.classList.add('incorrect');
        // æ­£è§£ã«è‰²
        document.querySelectorAll('.option').forEach(o=>{
          const idx = Number(o.getAttribute('data-opt'));
          if(idx === q.answer){ o.classList.add('correct'); }
        });
      }

      const exp = $('explanation');
      exp.innerHTML = `
        <div class="explanation-header" style="color:${isCorrect ? '#4caf50' : '#f44336'};">
          <span class="explanation-icon">ğŸ’¡</span>è§£èª¬
        </div>
        ${q.explanation}
      `;
      exp.style.borderLeftColor = isCorrect ? '#4caf50' : '#f44336';
      exp.style.display='block';
      requestAnimationFrame(()=> exp.style.opacity='1');

      $('next').disabled = false;
    };

    $('next').addEventListener('click', ()=>{
      if(current < order.length-1){ current++; renderQuestion(); }
      else{ showResult(); }
    });

    function showResult(){
      clearInterval(timer);
      const finalTime = $('timer').textContent;
      $('quiz-container').style.display = 'none';

      const total = order.length;
      const pct = (score/total)*100;
      let color = '#34c759', msg = 'ç´ æ™´ã‚‰ã—ã„æˆç¸¾ã§ã™ï¼ã“ã®èª¿å­ã§å­¦ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚';
      if(pct < 40){ color = '#ff3b30'; msg = 'ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼é–“é•ãˆãŸå•é¡Œã‚’ä¸­å¿ƒã«ã—ã£ã‹ã‚Šå¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚'; }
      else if(pct < 80){ color = '#ff9500'; msg = 'ã‚ã¨ä¸€æ­©ï¼é–“é•ãˆãŸç®‡æ‰€ã‚’å¾©ç¿’ã™ã‚Œã°ã€ã•ã‚‰ã«å®ŸåŠ›ãŒã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚'; }
      
      let skullHTML = '';
      if(pct === 100){ 
        msg = 'å®Œç’§ã§ã™ï¼ç´ æ™´ã‚‰ã—ã„é›†ä¸­åŠ›ã¨çŸ¥è­˜ã§ã™ã€‚ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼';
        createConfetti(); // ç´™å¹é›ªã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        skullHTML = `
          <div id="skull-celebration">
            ${createSkullSVG()}
            <div class="celebration-text">ğŸ‰ ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆï¼ ğŸ‰</div>
          </div>
        `;
      }

      // æˆç¸¾ã‚µãƒãƒªãƒ¼
      const modeText = isRetryMode ? ' (é–“é•ã„ç›´ã—ãƒ¢ãƒ¼ãƒ‰)' : '';
      const summary = `
        <div class="result-card" id="summary-card">
          ${skullHTML}
          <div class="summary-grid">
            <div class="score-display">
              <div class="score-circle" style="--p:${pct.toFixed(1)}; --c:${color};">
                <span class="score-percentage">${Math.round(pct)}<small>%</small></span>
              </div>
            </div>
            <div class="stats-details">
              <div class="stat-item"><span class="stat-icon">âœ…</span><span class="stat-label">æ­£è§£æ•°</span><span class="stat-value">${score} / ${total}${modeText}</span></div>
              <div class="stat-item"><span class="stat-icon">â±ï¸</span><span class="stat-label">æ‰€è¦æ™‚é–“</span><span class="stat-value">${finalTime}</span></div>
            </div>
          </div>
          <p class="feedback-message" style="color:${color};">${msg}</p>
        </div>
      `;

      // é–“é•ã„ä¸€è¦§
      wrongQuestions = [];
      order.forEach((qIndex)=>{
        if(userAnswers[qIndex] === null) return;
        if(userAnswers[qIndex] !== quizData[qIndex].answer){
          wrongQuestions.push(qIndex);
        }
      });

      let html = `<h2>ã‚¯ã‚¤ã‚ºçµæœ</h2>${summary}`;
      
      // é–“é•ã„ç›´ã—ãƒœã‚¿ãƒ³
      if(wrongQuestions.length > 0){
        html += `
          <div id="incorrect-summary">
            <h3>è¦å¾©ç¿’ã®å•é¡Œï¼ˆ${wrongQuestions.length}å•ï¼‰</h3>
            ${wrongQuestions.map(qi=>`<a href="#result-q-${qi+1}">å•${qi+1}</a>`).join('')}
            <button class="nav-button retry-wrong" onclick="retryWrongQuestions()">âŒ é–“é•ãˆãŸå•é¡Œã ã‘ã‚„ã‚Šç›´ã™</button>
          </div>
        `;
      }

      // å„å•ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼
      order.forEach((qIndex)=>{
        const q = quizData[qIndex];
        const ua = userAnswers[qIndex];
        const ok = (ua === q.answer);
        
        // å¾©ç¿’å±¥æ­´è¡¨ç¤º
        let historyHTML = '';
        if(retryHistory[qIndex] && retryHistory[qIndex].length > 0){
          const historyIcons = retryHistory[qIndex].map(correct => 
            correct ? 'âœ…' : 'âŒ'
          ).join(' ');
          historyHTML = `<p><strong>å¾©ç¿’å±¥æ­´:</strong> ${historyIcons}</p>`;
        }
        
        html += `
          <div class="result-card" id="result-q-${qIndex+1}">
            <h3>å•é¡Œ ${qIndex+1}</h3>
            <p class="result-status ${ok ? 'correct':'incorrect'}">${ok ? 'âœ… æ­£è§£':'âŒ ä¸æ­£è§£'}</p>
            ${historyHTML}
            <p><strong>è³ªå•:</strong> ${q.question}</p>
            <p><strong>ã‚ãªãŸã®å›ç­”:</strong> ${ua !== null ? q.options[ua] : 'æœªå›ç­”'}</p>
            <p><strong>æ­£è§£:</strong> ${q.options[q.answer]}</p>
            <p><strong>èª¬æ˜:</strong> ${q.explanation}</p>
          </div>
        `;
      });

      html += `<button class="nav-button" onclick="restartQuiz()">ğŸ”„ å…¨å•é¡Œã‚’ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>`;
      $('result-container').innerHTML = html;

      if(pct === 100 && !isRetryMode){
        const a = $('attendance-link');
        a.style.display = 'block';
        a.innerHTML = `<p>ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å…¨å•æ­£è§£ã§ã™ã€‚</p>
          <a href="https://forms.gle/ayBPd47Fr5orMXPP8" target="_blank" rel="noopener">å‡ºå¸­ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ ã«å›ç­”ã™ã‚‹</a>`;
      }
    }

    window.restartQuiz = function(){
      $('quiz-container').style.display = 'block';
      $('result-container').innerHTML = '';
      $('attendance-link').style.display = 'none';
      initQuiz(false);
    };

    window.retryWrongQuestions = function(){
      if(wrongQuestions.length === 0){
        alert('é–“é•ãˆãŸå•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“ï¼');
        return;
      }
      $('quiz-container').style.display = 'block';
      $('result-container').innerHTML = '';
      $('attendance-link').style.display = 'none';
      initQuiz(true, wrongQuestions);
    };

    // èµ·å‹•
    initTheme();
    initQuiz();
  </script>
</body>
</html>
