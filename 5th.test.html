<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ç¬¬5å›ç¢ºèªãƒ†ã‚¹ãƒˆï¼ˆå¥åº·éšœå®³ï¼‘ï¼šå¾ªç’°éšœå®³ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;
      line-height:1.6;color:#333;
      background:linear-gradient(135deg,#a8edea,#fed6e3);
      background-size:cover;background-repeat:no-repeat;background-attachment:fixed;
      padding:20px;margin:0;
    }
    .container{max-width:800px;margin:0 auto;}
    h1,h2{font-family:'Noto Sans JP',sans-serif;font-weight:700;text-align:center;}
    .quiz-container,.result-card{
      background-color:rgba(255,255,255,0.2);
      backdrop-filter:blur(10px);
      border-radius:16px;padding:20px;margin-bottom:20px;
      border:1px solid rgba(255,255,255,0.3);
      box-shadow:0 8px 24px rgba(0,0,0,0.2);
    }
    #progress-container{width:100%;background-color:rgba(255,255,255,0.3);border-radius:10px;margin-bottom:5px;padding:4px;}
    #progress-bar{height:12px;width:0%;background:linear-gradient(135deg,#007aff,#5ac8fa);border-radius:6px;transition:width .4s ease-in-out;}
    #progress-info{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:0 5px;font-weight:bold;font-size:.9em;color:#1d1d1f;}
    .question{font-size:1.3em;margin-bottom:20px;color:#1d1d1f;}
    .options{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;}
    .option{
      background-color:rgba(255,255,255,.7);border:none;border-radius:16px;padding:15px;
      font-size:1em;cursor:pointer;position:relative;overflow:hidden;text-align:center;
      transition:background .3s ease,transform .3s ease,box-shadow .3s ease;
      box-shadow:0 4px 8px rgba(0,0,0,.1);
    }
    .option:hover{background-color:#fff;box-shadow:0 8px 16px rgba(0,0,0,.2);transform:translateY(-2px);}
    .option.selected{color:#fff;}
    .option.disabled{pointer-events:none;}
    .option.correct{background:linear-gradient(135deg,#34c759,#a8e6cf);color:#fff;}
    .option.incorrect{background:linear-gradient(135deg,#ff3b30,#ff9a8b);color:#fff;}
    .explanation{
      margin-top:20px;font-size:1em;color:#333;background-color:rgba(255,255,255,.8);
      border-left:5px solid;border-radius:12px;padding:15px;
      box-shadow:0 4px 8px rgba(0,0,0,.1);display:none;opacity:0;transition:opacity .5s ease;
    }
    .explanation-header{display:flex;align-items:center;margin-bottom:10px;font-weight:bold;}
    .explanation-icon{font-size:1.5em;margin-right:10px;}
    .nav-button{
      background:linear-gradient(135deg,#007aff,#5ac8fa);color:#fff;border:none;border-radius:12px;
      padding:12px 24px;font-size:1em;cursor:pointer;width:100%;margin-top:20px;
      transition:background .3s ease,transform .2s ease,box-shadow .3s ease,opacity .3s ease;
      box-shadow:0 4px 8px rgba(0,0,0,.1);
    }
    .nav-button:hover{background:linear-gradient(135deg,#005bb5,#4aa0d3);box-shadow:0 8px 16px rgba(0,0,0,.2);}
    .nav-button:disabled{background:linear-gradient(135deg,#c7c7cc,#d1d1d6);opacity:.6;cursor:not-allowed;box-shadow:none;transform:none;}
    .nav-button:active{transform:scale(.98);}
    .nav-button.retry-wrong{
      background:linear-gradient(135deg,#ff9500,#ff6347);
      margin-top:10px;
    }
    .nav-button.retry-wrong:hover{
      background:linear-gradient(135deg,#cc7700,#cc5039);
    }
    .result-card h3{font-size:1.2em;margin-bottom:10px;}
    .result-status{font-weight:bold;margin-bottom:10px;}
    .correct{color:#34c759;}
    .incorrect{color:#ff3b30;}
    #incorrect-summary{background-color:rgba(255,235,238,.8);border:1px solid #ff3b30;border-radius:12px;padding:15px;margin-bottom:20px;}
    #incorrect-summary h3{margin-top:0;}
    #incorrect-summary a{display:inline-block;margin:5px;padding:5px 10px;background-color:#ff3b30;color:#fff;text-decoration:none;border-radius:8px;transition:background-color .3s;}
    #incorrect-summary a:hover{background-color:#c50000;}
    #attendance-link{background-color:#34c759;color:#fff;padding:15px;border-radius:12px;margin-top:20px;text-align:center;display:none;}
    #attendance-link a{color:#fff;text-decoration:none;font-weight:bold;}

    /* ---- ãƒ¢ãƒ¼ãƒ‰ãƒãƒƒã‚¸ ---- */
    .mode-badge{
      display:inline-block;
      background:linear-gradient(135deg,#ff9500,#ff6347);
      color:#fff;
      padding:8px 16px;
      border-radius:20px;
      font-size:0.9em;
      font-weight:bold;
      margin-bottom:15px;
      box-shadow:0 4px 8px rgba(0,0,0,0.2);
    }

    /* ---- æˆç¸¾ã‚«ãƒ¼ãƒ‰ ---- */
    #summary-card{background:rgba(255,255,255,.3);border:1px solid rgba(255,255,255,.4);padding:25px;}
    .summary-grid{display:flex;align-items:center;justify-content:center;gap:30px;flex-wrap:wrap;}
    .score-display{display:grid;place-items:center;}
    @property --p{syntax:'<number>';inherits:true;initial-value:0;}
    .score-circle{
      --p:20;--b:20px;--c:#34c759;--w:180px;
      width:var(--w);aspect-ratio:1;position:relative;display:inline-grid;margin:5px;
      place-content:center;font-size:2.5em;font-weight:bold;animation:progress-load 1s .5s both;
    }
    .score-circle:before,.score-circle:after{content:"";position:absolute;border-radius:50%;}
    .score-circle:before{
      inset:0;
      background:
        radial-gradient(farthest-side,var(--c) 98%,#0000) top/var(--b) var(--b) no-repeat,
        conic-gradient(var(--c) calc(var(--p)*1%),#0000 0);
      -webkit-mask:radial-gradient(farthest-side,#0000 calc(99% - var(--b)),#000 calc(100% - var(--b)));
              mask:radial-gradient(farthest-side,#0000 calc(99% - var(--b)),#000 calc(100% - var(--b)));
    }
    .score-circle:after{inset:calc(50% - var(--b)/2);background:var(--c);transform:rotate(calc(var(--p)*3.6deg)) translateY(calc(50% - var(--w)/2));}
    @keyframes progress-load{from{--p:0;}}
    .score-percentage small{font-size:.5em;color:#555;}
    .stats-details{display:flex;flex-direction:column;gap:15px;}
    .stat-item{display:flex;align-items:center;background-color:rgba(255,255,255,.5);border-radius:12px;padding:10px 15px;}
    .stat-icon{font-size:1.5em;margin-right:12px;}
    .stat-label{font-size:.9em;color:#333;margin-right:auto;}
    .stat-value{font-size:1.2em;font-weight:bold;color:#000;}
    .feedback-message{text-align:center;margin-top:20px;font-size:1.1em;font-weight:500;padding:10px;border-radius:10px;background-color:rgba(255,255,255,.3);}

    /* ---- ã‹ã‚ã„ã„é«‘é«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ ---- */
    #skull-celebration{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      margin:30px 0;
      animation:fadeInBounce 1s ease-out;
    }
    @keyframes fadeInBounce{
      0%{opacity:0;transform:translateY(-50px) scale(0.5);}
      60%{transform:translateY(10px) scale(1.1);}
      100%{opacity:1;transform:translateY(0) scale(1);}
    }
    #skull-celebration svg{
      width:200px;
      height:200px;
      filter:drop-shadow(0 10px 20px rgba(0,0,0,0.2));
      animation:float 3s ease-in-out infinite;
    }
    @keyframes float{
      0%, 100%{transform:translateY(0px);}
      50%{transform:translateY(-15px);}
    }
    #skull-celebration .celebration-text{
      font-size:1.5em;
      font-weight:bold;
      color:#ff1493;
      margin-top:20px;
      text-shadow:2px 2px 4px rgba(0,0,0,0.2);
      animation:textGlow 2s ease-in-out infinite;
    }
    @keyframes textGlow{
      0%, 100%{text-shadow:2px 2px 4px rgba(0,0,0,0.2);}
      50%{text-shadow:0 0 20px rgba(255,20,147,0.8), 2px 2px 4px rgba(0,0,0,0.2);}
    }

    /* ---- ç´™å¹é›ªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ ---- */
    .confetti{
      position:fixed;
      width:10px;
      height:10px;
      background:#ff1493;
      top:-10px;
      animation:confetti-fall 3s linear;
      pointer-events:none;
      z-index:9999;
    }
    @keyframes confetti-fall{
      to{
        transform:translateY(100vh) rotate(360deg);
        opacity:0;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ç¬¬5å›ç¢ºèªãƒ†ã‚¹ãƒˆï¼ˆå¥åº·éšœå®³ï¼‘ï¼šå¾ªç’°éšœå®³ï¼‰</h1>

    <div id="quiz-container" class="quiz-container">
      <div id="mode-indicator"></div>
      <div id="progress-container"><div id="progress-bar"></div></div>
      <div id="progress-info">
        <div id="progress-text"></div>
        <div id="timer">00:00</div>
      </div>

      <div id="quiz-content">
        <div id="question" class="question"></div>
        <div id="options" class="options"></div>
        <div id="explanation" class="explanation"></div>
      </div>
      <button id="next" class="nav-button" disabled>æ¬¡ã®å•é¡Œ</button>
    </div>

    <div id="result-container"></div>
    <div id="attendance-link"></div>
  </div>

  <script>
    // â€”â€” ã‚¯ã‚¤ã‚ºãƒ‡ãƒ¼ã‚¿ï¼ˆå¾ªç’°éšœå®³ï¼‰â€”â€”
    const quizData = [
      {
        "question":"å¾ªç’°å™¨ç³»ã«ãŠã‘ã‚‹ä½“å¾ªç’°ã®èª¬æ˜ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["å³å¿ƒå®¤ã‹ã‚‰è‚ºå‹•è„ˆã‚’çµŒã¦è‚ºã«è¡€æ¶²ã‚’é€ã‚‹çµŒè·¯","å·¦å¿ƒå®¤ã‹ã‚‰å¤§å‹•è„ˆã‚’çµŒã¦å…¨èº«ã«è¡€æ¶²ã‚’é€ã‚‹çµŒè·¯","è‚ºé™è„ˆã‹ã‚‰å·¦å¿ƒæˆ¿ã«è¡€æ¶²ã‚’é€ã‚‹çµŒè·¯","ä¸Šå¤§é™è„ˆã‹ã‚‰å³å¿ƒæˆ¿ã«è¡€æ¶²ã‚’é€ã‚‹çµŒè·¯"],
        "answer":1,
        "explanation":"ä½“å¾ªç’°ã¯å·¦å¿ƒå®¤ã‹ã‚‰å¤§å‹•è„ˆã‚’çµŒã¦å…¨èº«ã®çµ„ç¹”ã«é…¸ç´ ã¨æ „é¤Šã‚’å±Šã‘ã€é™è„ˆã‚’é€šã£ã¦å³å¿ƒæˆ¿ã«æˆ»ã£ã¦ãã‚‹çµŒè·¯ã§ã™ã€‚è‚ºå¾ªç’°ã¯å³å¿ƒå®¤ã‹ã‚‰è‚ºå‹•è„ˆã‚’çµŒã¦è‚ºã§é…¸ç´ äº¤æ›ã‚’è¡Œã†çµŒè·¯ã§ã™ã€‚"
      },
      {
        "question":"æ¯›ç´°è¡€ç®¡ã§æ°´åˆ†ãŒçµ„ç¹”ã«æŠ¼ã—å‡ºã•ã‚Œã‚‹ä»•çµ„ã¿ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["è† è³ªæµ¸é€åœ§ãŒè¡€åœ§ã‚ˆã‚Šé«˜ã„ãŸã‚","è¡€åœ§ãŒè† è³ªæµ¸é€åœ§ã‚ˆã‚Šé«˜ã„ãŸã‚","ãƒªãƒ³ãƒ‘ç®¡ã®å¸ååŠ›ãŒä½ä¸‹ã™ã‚‹ãŸã‚","è¡€ç®¡é€éæ€§ãŒè‘—ã—ãäº¢é€²ã™ã‚‹ãŸã‚"],
        "answer":1,
        "explanation":"æ¯›ç´°è¡€ç®¡ã®å‹•è„ˆå´ã§ã¯è¡€åœ§ï¼ˆç´„35mmHgï¼‰ãŒè† è³ªæµ¸é€åœ§ï¼ˆç´„25mmHgï¼‰ã‚’ä¸Šå›ã‚‹ãŸã‚ã€å·®ã—å¼•ãç´„10mmHgã®åŠ›ã§æ°´åˆ†ãŒçµ„ç¹”é–“éš™ã«æ¿¾éã•ã‚Œã¾ã™ã€‚é™è„ˆå´ã§ã¯é€†ã«è¡€åœ§ãŒä½ä¸‹ã—ã¦å†å¸åãŒèµ·ã“ã‚Šã¾ã™ã€‚"
      },
      {
        "question":"é–€è„ˆåœ§äº¢é€²ç—‡ã®æœ€ã‚‚å±é™ºãªåˆä½µç—‡ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["è„¾è…«","è…¹æ°´","é£Ÿé“é™è„ˆç˜¤ç ´è£‚","è‚è…«å¤§"],
        "answer":2,
        "explanation":"é–€è„ˆåœ§äº¢é€²ç—‡ã§ã¯å´å‰¯è¡€è¡Œè·¯ã¨ã—ã¦é£Ÿé“é™è„ˆç˜¤ãŒå½¢æˆã•ã‚Œã¾ã™ãŒã€é£Ÿé“ã®é™è„ˆã¯è–„ãã‚‚ã‚ã„ãŸã‚ã€ç ´è£‚ã™ã‚‹ã¨å¤§é‡åè¡€ã‚’èµ·ã“ã—è‡´æ­»çš„ã«ãªã‚Šã¾ã™ã€‚ã“ã‚ŒãŒæœ€ã‚‚å±é™ºãªåˆä½µç—‡ã§ã™ã€‚"
      },
      {
        "question":"å……è¡€ã¨ã†ã£è¡€ã®é•ã„ã‚’æœ€ã‚‚æ­£ç¢ºã«èª¬æ˜ã—ã¦ã„ã‚‹ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["å……è¡€ã¯é™è„ˆæ€§ã€ã†ã£è¡€ã¯å‹•è„ˆæ€§ã®è¡€æµå¢—åŠ ","å……è¡€ã¯å‹•è„ˆæ€§ã®è¡€æµå¢—åŠ ã§çµ„ç¹”ã¯èµ¤è‰²ã€ã†ã£è¡€ã¯é™è„ˆæ€§ã®è¡€æ¶²åœæ»ã§çµ„ç¹”ã¯æš—èµ¤è‰²","å……è¡€ã¯ç—…çš„ã€ã†ã£è¡€ã¯ç”Ÿç†çš„åå¿œ","å……è¡€ã¯æ…¢æ€§ã€ã†ã£è¡€ã¯æ€¥æ€§ã®å¤‰åŒ–"],
        "answer":1,
        "explanation":"å……è¡€ã¯å‹•è„ˆãŒæ‹¡å¼µã—ã¦è¡€æµãŒå¢—åŠ ã™ã‚‹çŠ¶æ…‹ã§çµ„ç¹”ã¯é®®ç´…è‰²ã«ãªã‚Šã¾ã™ã€‚ã†ã£è¡€ã¯é™è„ˆã‹ã‚‰è¡€æ¶²ãŒæµã‚Œå‡ºãšåœæ»ã™ã‚‹çŠ¶æ…‹ã§ã€é…¸ç´ ã®å°‘ãªã„é™è„ˆè¡€ãŒæºœã¾ã‚‹ãŸã‚çµ„ç¹”ã¯æš—èµ¤è‰²ã«ãªã‚Šã¾ã™ã€‚"
      },
      {
        "question":"å·¦å¿ƒä¸å…¨ã®æ‚£è€…ãŒå¤œé–“ã«å‘¼å¸å›°é›£ã§ç›®ãŒè¦šã‚ã‚‹ç†ç”±ã¨ã—ã¦æœ€ã‚‚é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["å¤œé–“ã«è¡€åœ§ãŒä¸Šæ˜‡ã™ã‚‹ãŸã‚","ä»°è‡¥ä½ã«ã‚ˆã‚Šè‚ºå…¨ä½“ã«ã†ã£è¡€ãŒåºƒãŒã‚‹ãŸã‚","ç¡çœ ä¸­ã«å‘¼å¸å›æ•°ãŒæ¸›å°‘ã™ã‚‹ãŸã‚","å¤œé–“ã«å¿ƒæ‹æ•°ãŒå¢—åŠ ã™ã‚‹ãŸã‚"],
        "answer":1,
        "explanation":"å·¦å¿ƒä¸å…¨ã§ã¯è‚ºã†ã£è¡€ãŒç”Ÿã˜ã¾ã™ãŒã€ä»°è‡¥ä½ã§ã¯é‡åŠ›ã®å½±éŸ¿ãŒå‡ç­‰ã«ãªã‚Šè‚ºå…¨ä½“ã«ã†ã£è¡€ãŒåºƒãŒã‚‹ãŸã‚ç—‡çŠ¶ãŒæ‚ªåŒ–ã—ã¾ã™ã€‚ã“ã‚Œã‚’ç™ºä½œæ€§å¤œé–“å‘¼å¸å›°é›£ã¨ã„ã„ã€èµ·åº§ä½ã‚’ã¨ã‚‹ã¨ç—‡çŠ¶ãŒæ”¹å–„ã—ã¾ã™ã€‚"
      },
      {
        "question":"ãƒŠãƒ„ãƒ¡ã‚°è‚ãŒè¦‹ã‚‰ã‚Œã‚‹ç—…æ…‹ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["å·¦å¿ƒä¸å…¨","å³å¿ƒä¸å…¨","è‚ç¡¬å¤‰","é–€è„ˆåœ§äº¢é€²ç—‡"],
        "answer":1,
        "explanation":"å³å¿ƒä¸å…¨ã§ã¯ä½“é™è„ˆç³»ã«è¡€æ¶²ãŒæ»ç•™ã—ã€è‚è‡“ã«ã†ã£è¡€ãŒç”Ÿã˜ã¾ã™ã€‚ä¸­å¿ƒé™è„ˆå‘¨å›²ãŒæš—èµ¤è‰²ã€å‘¨è¾ºéƒ¨ãŒé»„è¤è‰²ã¨ãªã‚Šã€æ–­é¢ãŒãƒŠãƒ„ãƒ¡ã‚°ï¼ˆè‚‰è±†è”²ï¼‰ã«ä¼¼ãŸæ¨¡æ§˜ã‚’å‘ˆã—ã¾ã™ã€‚"
      },
      {
        "question":"æµ®è…«ã®åŸå› ã¨ã—ã¦èª¤ã£ã¦ã„ã‚‹ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["æ¯›ç´°è¡€ç®¡å†…åœ§ã®ä¸Šæ˜‡","è¡€æ¶²è† è³ªæµ¸é€åœ§ã®ä¸Šæ˜‡","æ¯›ç´°è¡€ç®¡å£ã®é€éæ€§äº¢é€²","ãƒªãƒ³ãƒ‘æ¶²ã®ã†ã£æ»"],
        "answer":1,
        "explanation":"æµ®è…«ã®4ã¤ã®åŸå› ã¯ã€â‘ æ¯›ç´°è¡€ç®¡å†…åœ§ã®ä¸Šæ˜‡ã€â‘¡è¡€æ¶²è† è³ªæµ¸é€åœ§ã®ä½ä¸‹ï¼ˆä¸Šæ˜‡ã§ã¯ãªã„ï¼‰ã€â‘¢è¡€ç®¡é€éæ€§äº¢é€²ã€â‘£ãƒªãƒ³ãƒ‘æµéšœå®³ã§ã™ã€‚è† è³ªæµ¸é€åœ§ãŒä¸Šæ˜‡ã™ã‚Œã°æ°´åˆ†ã¯è¡€ç®¡å†…ã«ä¿æŒã•ã‚Œã‚‹ãŸã‚æµ®è…«ã¯ç”Ÿã˜ã¾ã›ã‚“ã€‚"
      },
      {
        "question":"ãƒãƒ•ãƒ­ãƒ¼ã‚¼ç—‡å€™ç¾¤ã§ç‰¹å¾´çš„ãªæµ®è…«ã®éƒ¨ä½ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["ä¸‹è‚¢","é¡”é¢ãƒ»çœ¼ç¼","è…¹éƒ¨","ä¸Šè‚¢"],
        "answer":1,
        "explanation":"ãƒãƒ•ãƒ­ãƒ¼ã‚¼ç—‡å€™ç¾¤ã§ã¯è…è‡“ã‹ã‚‰å¤§é‡ã®ã‚¢ãƒ«ãƒ–ãƒŸãƒ³ãŒæ¼å‡ºã—ã€è¡€ä¸­ã‚¢ãƒ«ãƒ–ãƒŸãƒ³ãŒä½ä¸‹ã—ã¦è† è³ªæµ¸é€åœ§ãŒä½ä¸‹ã—ã¾ã™ã€‚ç‰¹ã«é¡”é¢ã‚„çœ¼ç¼ã®æµ®è…«ãŒç‰¹å¾´çš„ã§ã€æœèµ·ããŸã¨ãã«é¡”ãŒãƒ‘ãƒ³ãƒ‘ãƒ³ã«è…«ã‚Œã¾ã™ã€‚"
      },
      {
        "question":"æ­¢è¡€æ©Ÿæ§‹ã«ãŠã‘ã‚‹ä¸€æ¬¡æ­¢è¡€ã¨ã¯ä½•ã‚’æŒ‡ã—ã¾ã™ã‹ï¼Ÿ",
        "options":["è¡€ç®¡åç¸®","è¡€å°æ¿è¡€æ “ã®å½¢æˆ","ãƒ•ã‚£ãƒ–ãƒªãƒ³è¡€æ “ã®å½¢æˆ","å‡å›ºå› å­ã®æ´»æ€§åŒ–"],
        "answer":1,
        "explanation":"ä¸€æ¬¡æ­¢è¡€ã¯è¡€å°æ¿ã«ã‚ˆã‚‹æ­¢è¡€ã§ã€è¡€ç®¡æå‚·éƒ¨ä½ã«è¡€å°æ¿ãŒç²˜ç€ãƒ»å‡é›†ã—ã¦è¡€å°æ¿è¡€æ “ï¼ˆè¡€å°æ¿ãƒ—ãƒ©ã‚°ï¼‰ã‚’å½¢æˆã—ã¾ã™ã€‚äºŒæ¬¡æ­¢è¡€ã¯å‡å›ºã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ–ãƒªãƒ³è¡€æ “ã®å½¢æˆã§ã™ã€‚"
      },
      {
        "question":"ãƒ“ã‚¿ãƒŸãƒ³KãŒä¸è¶³ã™ã‚‹ã¨å‡ºè¡€å‚¾å‘ã«ãªã‚‹ç†ç”±ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["è¡€å°æ¿ã®æ•°ãŒæ¸›å°‘ã™ã‚‹ãŸã‚","è‚è‡“ã§ä½œã‚‰ã‚Œã‚‹å‡å›ºå› å­ï¼ˆãƒ—ãƒ­ãƒˆãƒ­ãƒ³ãƒ“ãƒ³ãªã©ï¼‰ãŒæ¸›å°‘ã™ã‚‹ãŸã‚","è¡€ç®¡å£ãŒã‚‚ã‚ããªã‚‹ãŸã‚","èµ¤è¡€çƒã®æ•°ãŒæ¸›å°‘ã™ã‚‹ãŸã‚"],
        "answer":1,
        "explanation":"ãƒ“ã‚¿ãƒŸãƒ³Kã¯è‚è‡“ã§ãƒ—ãƒ­ãƒˆãƒ­ãƒ³ãƒ“ãƒ³ï¼ˆå› å­â…¡ï¼‰ãªã©ã®å‡å›ºå› å­ã‚’åˆæˆã™ã‚‹ã®ã«å¿…é ˆã§ã™ã€‚ãƒ“ã‚¿ãƒŸãƒ³Kæ¬ ä¹ã‚„ãƒ¯ãƒ«ãƒ•ã‚¡ãƒªãƒ³ãªã©ã®è–¬å‰¤ã§ã¯ã“ã‚Œã‚‰ã®å› å­ãŒä½ä¸‹ã—ã€å‡ºè¡€å‚¾å‘ã«ãªã‚Šã¾ã™ã€‚"
      },
      {
        "question":"è¡€æ “ãŒã§ãã‚„ã™ããªã‚‹3ã¤ã®è¦å› ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["è¡€ç®¡å†…çš®ã®æå‚·ã€è¡€æµã®åœæ»ã€è¡€æ¶²ãŒå›ºã¾ã‚Šã‚„ã™ã„çŠ¶æ…‹","è¡€åœ§ä¸Šæ˜‡ã€è„ˆæ‹å¢—åŠ ã€ä½“æ¸©ä¸Šæ˜‡","è²§è¡€ã€è„±æ°´ã€ä½æ „é¤Š","æ„ŸæŸ“ã€ç‚ç—‡ã€å…ç–«ç•°å¸¸"],
        "answer":0,
        "explanation":"è¡€æ “å½¢æˆã®3å¤§è¦å› ã¯ã€â‘ è¡€ç®¡å†…çš®ã®éšœå®³ï¼ˆå‹•è„ˆç¡¬åŒ–ãªã©ï¼‰ã€â‘¡è¡€æµã®ã†ã£æ»ï¼ˆé•·æ™‚é–“ã®è‡¥åºŠãªã©ï¼‰ã€â‘¢è¡€æ¶²ã®å‡å›ºäº¢é€²ï¼ˆç™Œã‚„æ„ŸæŸ“ç—‡ãªã©ï¼‰ã§ã™ã€‚ã“ã®3ã¤ãŒ19ä¸–ç´€ã®ã‚¦ã‚£ãƒ«ãƒ’ãƒ§ã‚¦ã«ã‚ˆã£ã¦æå”±ã•ã‚Œã¾ã—ãŸã€‚"
      },
      {
        "question":"ã‚¨ã‚³ãƒãƒŸãƒ¼ã‚¯ãƒ©ã‚¹ç—‡å€™ç¾¤ï¼ˆæ·±éƒ¨é™è„ˆè¡€æ “ç—‡ï¼‰ã§æœ€ã‚‚é‡ç¯¤ãªåˆä½µç—‡ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["ä¸‹è‚¢ã®è…«è„¹","ä¸‹è‚¢ã®ç–¼ç—›","è‚ºå¡æ “ç—‡","é™è„ˆç˜¤"],
        "answer":2,
        "explanation":"æ·±éƒ¨é™è„ˆè¡€æ “ç—‡ã§å½¢æˆã•ã‚ŒãŸè¡€æ “ãŒéŠé›¢ã—ã¦è‚ºå‹•è„ˆã‚’é–‰å¡ã™ã‚‹ã¨è‚ºå¡æ “ç—‡ã¨ãªã‚Šã€çªç„¶ã®å‘¼å¸å›°é›£ã€èƒ¸ç—›ã€ã‚·ãƒ§ãƒƒã‚¯ã‚’èµ·ã“ã—ã¦è‡´æ­»çš„ã«ãªã‚Šãˆã¾ã™ã€‚ã“ã‚ŒãŒæœ€ã‚‚é‡ç¯¤ãªåˆä½µç—‡ã§ã™ã€‚"
      },
      {
        "question":"çµ‚å‹•è„ˆã¨ã¯ã©ã®ã‚ˆã†ãªå‹•è„ˆã‚’æŒ‡ã—ã¾ã™ã‹ï¼Ÿ",
        "options":["æœ€ã‚‚å¤ªã„å‹•è„ˆ","æœ€ã‚‚ç´°ã„å‹•è„ˆ","ä»–ã®å‹•è„ˆã¨ã®å»åˆï¼ˆå´å‰¯è¡€è¡Œè·¯ï¼‰ã‚’æŒãŸãªã„ã€ã¾ãŸã¯æ©Ÿèƒ½çš„ã«ä¸ååˆ†ãªå‹•è„ˆ","é™è„ˆã¨ç›´æ¥ã¤ãªãŒã‚‹å‹•è„ˆ"],
        "answer":2,
        "explanation":"çµ‚å‹•è„ˆã¨ã¯å´å‰¯è¡€è¡Œè·¯ã‚’æŒãŸãªã„ã€ã¾ãŸã¯æ©Ÿèƒ½çš„ã«ä¸ååˆ†ãªå‹•è„ˆã®ã“ã¨ã§ã™ã€‚è„³ã€å¿ƒè‡“ã€è…è‡“ãªã©ã®å‹•è„ˆã¯çµ‚å‹•è„ˆã®æ€§è³ªã‚’æŒã¡ã€é–‰å¡ã™ã‚‹ã¨ãã®æ”¯é…é ˜åŸŸå…¨ä½“ãŒæ¢—å¡ã«ãªã‚Šã¾ã™ã€‚"
      },
      {
        "question":"è²§è¡€æ€§æ¢—å¡ãŒèµ·ã“ã‚‹è‡“å™¨ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["è‚è‡“","è‚º","è„³","è…¸ç®¡"],
        "answer":2,
        "explanation":"è²§è¡€æ€§æ¢—å¡ã¯å´å‰¯è¡€è¡Œè·¯ã®ãªã„ç·»å¯†ãªçµ„ç¹”ï¼ˆè„³ã€å¿ƒè‡“ã€è…è‡“ï¼‰ã§èµ·ã“ã‚Šã€æ¢—å¡å·£ã¯ç™½è‰²ã‚’å‘ˆã—ã¾ã™ã€‚è‚è‡“ã‚„è‚ºã¯äºŒé‡ã®è¡€æ¶²ä¾›çµ¦ãŒã‚ã‚‹ãŸã‚å‡ºè¡€æ€§æ¢—å¡ã«ãªã‚Šã¾ã™ã€‚"
      },
      {
        "question":"ç‹­å¿ƒç—‡ã¨å¿ƒç­‹æ¢—å¡ã®é‘‘åˆ¥ã§æœ€ã‚‚é‡è¦ãªé•ã„ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["ç‹­å¿ƒç—‡ã¯å¯é€†çš„è™šè¡€ã€å¿ƒç­‹æ¢—å¡ã¯ä¸å¯é€†çš„å£Šæ­»","ç‹­å¿ƒç—‡ã¯å¤œé–“ã«èµ·ã“ã‚Šã€å¿ƒç­‹æ¢—å¡ã¯æ—¥ä¸­ã«èµ·ã“ã‚‹","ç‹­å¿ƒç—‡ã¯å¥³æ€§ã«å¤šãã€å¿ƒç­‹æ¢—å¡ã¯ç”·æ€§ã«å¤šã„","ç‹­å¿ƒç—‡ã¯äºˆå¾Œè‰¯å¥½ã€å¿ƒç­‹æ¢—å¡ã¯å¿…ãšè‡´æ­»çš„"],
        "answer":0,
        "explanation":"ç‹­å¿ƒç—‡ã¯å† å‹•è„ˆã®ç‹­çª„ã«ã‚ˆã‚‹ä¸€éæ€§ã®è™šè¡€ã§ã€å®‰é™ã‚„ãƒ‹ãƒˆãƒ­ã‚°ãƒªã‚»ãƒªãƒ³ã§æ”¹å–„ã™ã‚‹å¯é€†çš„ãªçŠ¶æ…‹ã§ã™ã€‚å¿ƒç­‹æ¢—å¡ã¯å† å‹•è„ˆã®å®Œå…¨é–‰å¡ã«ã‚ˆã‚‹å¿ƒç­‹å£Šæ­»ã§ã€ä¸å¯é€†çš„ãªçµ„ç¹”éšœå®³ã§ã™ã€‚"
      },
      {
        "question":"åŒ»å­¦ç”¨èªã¨ã—ã¦ã®ã‚·ãƒ§ãƒƒã‚¯ã‚’æœ€ã‚‚æ­£ç¢ºã«èª¬æ˜ã—ã¦ã„ã‚‹ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["ç²¾ç¥çš„ã«å¼·ã„è¡æ’ƒã‚’å—ã‘ãŸçŠ¶æ…‹","æ€¥æ¿€ãªè¡€åœ§ä½ä¸‹ã«ã‚ˆã‚Šå…¨èº«çµ„ç¹”ã¸ã®è¡€æµãŒè‘—ã—ãä½ä¸‹ã—ã€ç´°èƒä»£è¬ãŒç¶­æŒã§ããªããªã£ãŸçŠ¶æ…‹","å¿ƒè‡“ãŒå®Œå…¨ã«åœæ­¢ã—ãŸçŠ¶æ…‹","æ„è­˜ã‚’å¤±ã£ãŸçŠ¶æ…‹"],
        "answer":1,
        "explanation":"ã‚·ãƒ§ãƒƒã‚¯ã¨ã¯ã€é‡ç¯¤ãªç”Ÿä½“ä¾µè¥²ã«ã‚ˆã‚Šæœ‰åŠ¹å¾ªç’°è¡€æ¶²é‡ãŒæ¸›å°‘ã—ã€è¡€åœ§ãŒä½ä¸‹ã—ã¦å…¨èº«çµ„ç¹”ã¸ã®è¡€æµãŒè‘—ã—ãä½ä¸‹ã—ã€ç´°èƒã®ä»£è¬ãŒç¶­æŒã§ããªããªã£ãŸç”Ÿå‘½ã®å±æ©Ÿã«ç›´çµã™ã‚‹çŠ¶æ…‹ã§ã™ã€‚"
      },
      {
        "question":"æ•—è¡€ç—‡æ€§ã‚·ãƒ§ãƒƒã‚¯ã®åˆ†é¡ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["å¾ªç’°è¡€æ¶²é‡æ¸›å°‘æ€§ã‚·ãƒ§ãƒƒã‚¯","å¿ƒåŸæ€§ã‚·ãƒ§ãƒƒã‚¯","è¡€æ¶²åˆ†å¸ƒç•°å¸¸æ€§ã‚·ãƒ§ãƒƒã‚¯","é–‰å¡æ€§ã‚·ãƒ§ãƒƒã‚¯"],
        "answer":2,
        "explanation":"æ•—è¡€ç—‡æ€§ã‚·ãƒ§ãƒƒã‚¯ã¯ã€ç´°èŒæ¯’ç´ ã«ã‚ˆã‚Šè¡€ç®¡ãŒæ‹¡å¼µã—ã¦è¡€æ¶²ãŒæœ«æ¢¢ã«æºœã¾ã‚Šã€æœ‰åŠ¹å¾ªç’°è¡€æ¶²é‡ãŒæ¸›å°‘ã™ã‚‹è¡€æ¶²åˆ†å¸ƒç•°å¸¸æ€§ã‚·ãƒ§ãƒƒã‚¯ã«åˆ†é¡ã•ã‚Œã¾ã™ã€‚ã‚¢ãƒŠãƒ•ã‚£ãƒ©ã‚­ã‚·ãƒ¼ã‚„ç¥çµŒåŸæ€§ã‚·ãƒ§ãƒƒã‚¯ã‚‚åŒã˜åˆ†é¡ã§ã™ã€‚"
      },
      {
        "question":"ã‚·ãƒ§ãƒƒã‚¯æ™‚ã®ä»£å„Ÿæ©Ÿè»¢ã¨ã—ã¦èª¤ã£ã¦ã„ã‚‹ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["å¿ƒæ‹æ•°ã®å¢—åŠ ","æœ«æ¢¢è¡€ç®¡ã®æ‹¡å¼µ","ãƒ¬ãƒ‹ãƒ³-ã‚¢ãƒ³ã‚¸ã‚ªãƒ†ãƒ³ã‚·ãƒ³-ã‚¢ãƒ«ãƒ‰ã‚¹ãƒ†ãƒ­ãƒ³ç³»ã®æ´»æ€§åŒ–","äº¤æ„Ÿç¥çµŒã®æ´»æ€§åŒ–"],
        "answer":1,
        "explanation":"ã‚·ãƒ§ãƒƒã‚¯æ™‚ã®ä»£å„Ÿæ©Ÿè»¢ã§ã¯ã€äº¤æ„Ÿç¥çµŒãŒæ´»æ€§åŒ–ã—ã¦å¿ƒæ‹æ•°ãŒå¢—åŠ ã—ã€æœ«æ¢¢è¡€ç®¡ã¯åç¸®ï¼ˆæ‹¡å¼µã§ã¯ãªã„ï¼‰ã—ã¦è¡€åœ§ã‚’ç¶­æŒã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚ã¾ãŸã€æ°´åˆ†ãƒ»ãƒŠãƒˆãƒªã‚¦ãƒ ã®å†å¸åã‚‚ä¿ƒé€²ã•ã‚Œã¾ã™ã€‚"
      },
      {
        "question":"DICï¼ˆæ’­ç¨®æ€§è¡€ç®¡å†…å‡å›ºç—‡å€™ç¾¤ï¼‰ã§è¡€æ “ã¨å‡ºè¡€ãŒåŒæ™‚ã«èµ·ã“ã‚‹ç†ç”±ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["å…ç–«ç³»ãŒç•°å¸¸ã«æ´»æ€§åŒ–ã™ã‚‹ãŸã‚","å…¨èº«ã§å‡å›ºãŒé€²è¡Œã—ã¦å‡å›ºå› å­ã¨è¡€å°æ¿ãŒæ¶ˆè²»ã•ã‚Œæ¯æ¸‡ã™ã‚‹ãŸã‚","è‚è‡“ã§ã®å‡å›ºå› å­åˆæˆãŒäº¢é€²ã™ã‚‹ãŸã‚","è…è‡“ã§ã®è¡€å°æ¿ç”£ç”ŸãŒä½ä¸‹ã™ã‚‹ãŸã‚"],
        "answer":1,
        "explanation":"DICã§ã¯å…¨èº«ã®å¾®å°è¡€ç®¡ã§è¡€æ “ãŒå¤šç™ºã—ã€å‡å›ºå› å­ã¨è¡€å°æ¿ãŒå¤§é‡ã«æ¶ˆè²»ã•ã‚Œã¾ã™ï¼ˆæ¶ˆè²»æ€§å‡å›ºéšœå®³ï¼‰ã€‚ãã®çµæœã€ã“ã‚Œã‚‰ãŒæ¯æ¸‡ã—ã¦é€†ã«å‡ºè¡€å‚¾å‘ã«ãªã‚‹ã¨ã„ã†çŸ›ç›¾ã—ãŸç—…æ…‹ãŒç”Ÿã˜ã¾ã™ã€‚"
      },
      {
        "question":"ã‚·ãƒ§ãƒƒã‚¯è‚ºï¼ˆARDSï¼‰ã®ç‰¹å¾´çš„ãªç—…ç†æ‰€è¦‹ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
        "options":["è‚ºèƒå£ã¸ã®ç¡å­è†œå½¢æˆ","è‚ºèƒå†…ã¸ã®ç™Œç´°èƒæµ¸æ½¤","è‚ºå‹•è„ˆã®å‹•è„ˆç¡¬åŒ–","æ°—ç®¡æ”¯ã®æ…¢æ€§ç‚ç—‡"],
        "answer":0,
        "explanation":"ã‚·ãƒ§ãƒƒã‚¯è‚ºï¼ˆæ€¥æ€§å‘¼å¸çª®è¿«ç—‡å€™ç¾¤ï¼‰ã§ã¯ã€ç‚ç—‡ã«ã‚ˆã‚Šè¡€ç®¡é€éæ€§ãŒäº¢é€²ã—ã¦è‚ºæ°´è…«ãŒç”Ÿã˜ã€è‚ºèƒå£ã«ç¡å­è†œã¨ã„ã†ãƒ”ãƒ³ã‚¯è‰²ã®ç„¡æ§‹é€ ãªè†œãŒå½¢æˆã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã‚¬ã‚¹äº¤æ›ãŒè‘—ã—ãéšœå®³ã•ã‚Œã¾ã™ã€‚"
      }
    ];

    // â€”â€” ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ â€”â€” 
    const $ = (id) => document.getElementById(id);
    function shuffle(array){
      for(let i=array.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [array[i],array[j]] = [array[j],array[i]];
      }
      return array;
    }

    // â€”â€” ç´™å¹é›ªã‚¨ãƒ•ã‚§ã‚¯ãƒˆ â€”â€” 
    function createConfetti(){
      const colors = ['#ff1493','#00bfff','#ffd700','#ff6347','#98fb98','#dda0dd'];
      for(let i=0;i<50;i++){
        setTimeout(()=>{
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random()*100 + '%';
          confetti.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
          confetti.style.animationDuration = (Math.random()*2 + 2) + 's';
          confetti.style.animationDelay = Math.random()*0.5 + 's';
          document.body.appendChild(confetti);
          setTimeout(()=> confetti.remove(), 4000);
        }, i*50);
      }
    }

    // â€”â€” ã‹ã‚ã„ã„é«‘é«SVGã‚’ç”Ÿæˆ â€”â€” 
    function createSkullSVG(){
      return `
        <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
          <!-- é ­è“‹éª¨æœ¬ä½“ -->
          <ellipse cx="100" cy="90" rx="70" ry="75" fill="#f0f0f0" stroke="#333" stroke-width="3"/>
          
          <!-- å·¦ç›® -->
          <ellipse cx="75" cy="80" rx="18" ry="22" fill="#333"/>
          <ellipse cx="78" cy="75" rx="8" ry="10" fill="#fff" opacity="0.6"/>
          <circle cx="80" cy="78" r="3" fill="#fff"/>
          
          <!-- å³ç›® -->
          <ellipse cx="125" cy="80" rx="18" ry="22" fill="#333"/>
          <ellipse cx="128" cy="75" rx="8" ry="10" fill="#fff" opacity="0.6"/>
          <circle cx="130" cy="78" r="3" fill="#fff"/>
          
          <!-- é¼» -->
          <path d="M 95 100 L 100 110 L 105 100 Z" fill="#333"/>
          
          <!-- ç¬‘é¡”ã®å£ -->
          <path d="M 70 125 Q 100 145 130 125" stroke="#333" stroke-width="3" fill="none" stroke-linecap="round"/>
          
          <!-- æ­¯ -->
          <rect x="75" y="123" width="8" height="12" fill="#fff" stroke="#333" stroke-width="1"/>
          <rect x="85" y="125" width="8" height="12" fill="#fff" stroke="#333" stroke-width="1"/>
          <rect x="95" y="127" width="8" height="12" fill="#fff" stroke="#333" stroke-width="1"/>
          <rect x="105" y="125" width="8" height="12" fill="#fff" stroke="#333" stroke-width="1"/>
          <rect x="115" y="123" width="8" height="12" fill="#fff" stroke="#333" stroke-width="1"/>
          
          <!-- é ¬ã®èµ¤ã¿ -->
          <ellipse cx="55" cy="100" rx="12" ry="10" fill="#ff69b4" opacity="0.5"/>
          <ellipse cx="145" cy="100" rx="12" ry="10" fill="#ff69b4" opacity="0.5"/>
          
          <!-- ç‹å†  -->
          <path d="M 50 50 L 55 35 L 60 50 L 75 30 L 90 50 L 100 25 L 110 50 L 125 30 L 140 50 L 145 35 L 150 50 Z" 
                fill="#ffd700" stroke="#ff8c00" stroke-width="2"/>
          
          <!-- ç‹å† ã®å®çŸ³ -->
          <circle cx="75" cy="40" r="4" fill="#ff1493"/>
          <circle cx="100" cy="35" r="5" fill="#00bfff"/>
          <circle cx="125" cy="40" r="4" fill="#ff1493"/>
          
          <!-- ã‚­ãƒ©ã‚­ãƒ©åŠ¹æœ -->
          <g opacity="0.8">
            <path d="M 165 60 l 3 -8 l 3 8 l 8 3 l -8 3 l -3 8 l -3 -8 l -8 -3 z" fill="#ffd700">
              <animateTransform attributeName="transform" type="rotate" 
                from="0 168 63" to="360 168 63" dur="4s" repeatCount="indefinite"/>
            </path>
            <path d="M 35 70 l 2 -6 l 2 6 l 6 2 l -6 2 l -2 6 l -2 -6 l -6 -2 z" fill="#ffd700">
              <animateTransform attributeName="transform" type="rotate" 
                from="0 37 72" to="360 37 72" dur="3s" repeatCount="indefinite"/>
            </path>
          </g>
          
          <!-- ãƒãƒ¼ãƒˆ -->
          <path d="M 100 170 C 80 150, 50 150, 50 130 C 50 110, 70 100, 100 120 C 130 100, 150 110, 150 130 C 150 150, 120 150, 100 170 Z" 
                fill="#ff1493" stroke="#c71585" stroke-width="2" opacity="0.8">
            <animate attributeName="opacity" values="0.8;1;0.8" dur="1.5s" repeatCount="indefinite"/>
          </path>
        </svg>
      `;
    }

    // â€”â€” çŠ¶æ…‹ â€”â€” 
    let current = 0, score = 0, userAnswers = [];
    let order = [];        // å…¨è¨­å•ã®ä¸¦ã³
    let optionOrder = [];  // å„è¨­å•ã”ã¨ã®é¸æŠè‚¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä¸¦ã³
    let timer = null, seconds = 0;
    let isRetryMode = false; // é–“é•ã„ç›´ã—ãƒ¢ãƒ¼ãƒ‰ãƒ•ãƒ©ã‚°
    let wrongQuestions = []; // é–“é•ãˆãŸå•é¡Œã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒªã‚¹ãƒˆ
    let retryHistory = {}; // å„å•é¡Œã®å¾©ç¿’å±¥æ­´ã‚’ä¿å­˜

    function startTimer(){
      if(timer) clearInterval(timer);
      seconds = 0; $('timer').textContent = '00:00';
      timer = setInterval(()=>{
        seconds++;
        const m = String(Math.floor(seconds/60)).padStart(2,'0');
        const s = String(seconds%60).padStart(2,'0');
        $('timer').textContent = `${m}:${s}`;
      },1000);
    }

    function initQuiz(retryMode = false, retryQuestions = []){
      isRetryMode = retryMode;
      
      if(isRetryMode){
        // é–“é•ã„ç›´ã—ãƒ¢ãƒ¼ãƒ‰
        order = shuffle([...retryQuestions]);
        $('mode-indicator').innerHTML = '<div class="mode-badge">ğŸ”„ é–“é•ã„ç›´ã—ãƒ¢ãƒ¼ãƒ‰</div>';
      } else {
        // é€šå¸¸ãƒ¢ãƒ¼ãƒ‰
        order = shuffle([...Array(quizData.length).keys()]);
        $('mode-indicator').innerHTML = '';
        retryHistory = {}; // å±¥æ­´ãƒªã‚»ãƒƒãƒˆ
      }
      
      // å„è¨­å•ã®é¸æŠè‚¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
      optionOrder = order.map(qi => shuffle([0,1,2,3]));
      userAnswers = Array(quizData.length).fill(null);
      current = 0; score = 0;
      startTimer();
      renderQuestion();
    }

    function renderQuestion(){
      const qIndex = order[current];
      const q = quizData[qIndex];

      // é€²æ—
      const prog = ((current+1)/order.length)*100;
      $('progress-bar').style.width = `${prog}%`;
      $('progress-text').textContent = `${current+1} / ${order.length} å•`;

      // æœ¬æ–‡
      $('question').textContent = q.question;

      // é¸æŠè‚¢ï¼ˆindexã§å®‰å…¨ã«ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼‰
      const idxOrder = optionOrder[current];
      $('options').innerHTML = idxOrder.map((optIdx,i)=>(
        `<button class="option" data-opt="${optIdx}" onclick="selectOption(${optIdx}, this)">${q.options[optIdx]}</button>`
      )).join('');

      // è§£èª¬ãƒªã‚»ãƒƒãƒˆ
      const exp = $('explanation');
      exp.style.display='none'; exp.style.opacity='0'; exp.innerHTML='';
      $('next').disabled = true;
    }

    window.selectOption = function(originalOptionIndex, el){
      // å…¨ã¦ç„¡åŠ¹åŒ–
      document.querySelectorAll('.option').forEach(o=>o.classList.add('disabled'));
      el.classList.add('selected');

      const qIndex = order[current];
      const q = quizData[qIndex];
      const isCorrect = (originalOptionIndex === q.answer);
      userAnswers[qIndex] = originalOptionIndex;
      
      // å¾©ç¿’å±¥æ­´ã‚’è¨˜éŒ²
      if(isRetryMode){
        if(!retryHistory[qIndex]) retryHistory[qIndex] = [];
        retryHistory[qIndex].push(isCorrect);
      }
      
      if(isCorrect){ el.classList.add('correct'); score++; }
      else{
        el.classList.add('incorrect');
        // æ­£è§£ã«è‰²
        document.querySelectorAll('.option').forEach(o=>{
          const idx = Number(o.getAttribute('data-opt'));
          if(idx === q.answer){ o.classList.add('correct'); }
        });
      }

      const exp = $('explanation');
      exp.innerHTML = `
        <div class="explanation-header" style="color:${isCorrect ? '#4caf50' : '#f44336'};">
          <span class="explanation-icon">ğŸ’¡</span>è§£èª¬
        </div>
        ${q.explanation}
      `;
      exp.style.borderLeftColor = isCorrect ? '#4caf50' : '#f44336';
      exp.style.display='block';
      requestAnimationFrame(()=> exp.style.opacity='1');

      $('next').disabled = false;
    };

    $('next').addEventListener('click', ()=>{
      if(current < order.length-1){ current++; renderQuestion(); }
      else{ showResult(); }
    });

    function showResult(){
      clearInterval(timer);
      const finalTime = $('timer').textContent;
      $('quiz-container').style.display = 'none';

      const total = order.length;
      const pct = (score/total)*100;
      let color = '#34c759', msg = 'ç´ æ™´ã‚‰ã—ã„æˆç¸¾ã§ã™ï¼ã“ã®èª¿å­ã§å­¦ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚';
      if(pct < 40){ color = '#ff3b30'; msg = 'ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼é–“é•ãˆãŸå•é¡Œã‚’ä¸­å¿ƒã«ã—ã£ã‹ã‚Šå¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚'; }
      else if(pct < 80){ color = '#ff9500'; msg = 'ã‚ã¨ä¸€æ­©ï¼é–“é•ãˆãŸç®‡æ‰€ã‚’å¾©ç¿’ã™ã‚Œã°ã€ã•ã‚‰ã«å®ŸåŠ›ãŒã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚'; }
      
      let skullHTML = '';
      if(pct === 100){ 
        msg = 'å®Œç’§ã§ã™ï¼ç´ æ™´ã‚‰ã—ã„é›†ä¸­åŠ›ã¨çŸ¥è­˜ã§ã™ã€‚ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼';
        createConfetti(); // ç´™å¹é›ªã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        skullHTML = `
          <div id="skull-celebration">
            ${createSkullSVG()}
            <div class="celebration-text">ğŸ‰ ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆï¼ ğŸ‰</div>
          </div>
        `;
      }

      // æˆç¸¾ã‚µãƒãƒªãƒ¼
      const modeText = isRetryMode ? ' (é–“é•ã„ç›´ã—ãƒ¢ãƒ¼ãƒ‰)' : '';
      const summary = `
        <div class="result-card" id="summary-card">
          ${skullHTML}
          <div class="summary-grid">
            <div class="score-display">
              <div class="score-circle" style="--p:${pct.toFixed(1)}; --c:${color};">
                <span class="score-percentage">${Math.round(pct)}<small>%</small></span>
              </div>
            </div>
            <div class="stats-details">
              <div class="stat-item"><span class="stat-icon">âœ…</span><span class="stat-label">æ­£è§£æ•°</span><span class="stat-value">${score} / ${total}${modeText}</span></div>
              <div class="stat-item"><span class="stat-icon">â±ï¸</span><span class="stat-label">æ‰€è¦æ™‚é–“</span><span class="stat-value">${finalTime}</span></div>
            </div>
          </div>
          <p class="feedback-message" style="color:${color};">${msg}</p>
        </div>
      `;

      // é–“é•ã„ä¸€è¦§
      wrongQuestions = [];
      order.forEach((qIndex)=>{
        if(userAnswers[qIndex] === null) return;
        if(userAnswers[qIndex] !== quizData[qIndex].answer){
          wrongQuestions.push(qIndex);
        }
      });

      let html = `<h2>ã‚¯ã‚¤ã‚ºçµæœ</h2>${summary}`;
      
      // é–“é•ã„ç›´ã—ãƒœã‚¿ãƒ³
      if(wrongQuestions.length > 0){
        html += `
          <div id="incorrect-summary">
            <h3>è¦å¾©ç¿’ã®å•é¡Œï¼ˆ${wrongQuestions.length}å•ï¼‰</h3>
            ${wrongQuestions.map(qi=>`<a href="#result-q-${qi+1}">å•${qi+1}</a>`).join('')}
            <button class="nav-button retry-wrong" onclick="retryWrongQuestions()">âŒ é–“é•ãˆãŸå•é¡Œã ã‘ã‚„ã‚Šç›´ã™</button>
          </div>
        `;
      }

      // å„å•ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼
      order.forEach((qIndex)=>{
        const q = quizData[qIndex];
        const ua = userAnswers[qIndex];
        const ok = (ua === q.answer);
        
        // å¾©ç¿’å±¥æ­´è¡¨ç¤º
        let historyHTML = '';
        if(retryHistory[qIndex] && retryHistory[qIndex].length > 0){
          const historyIcons = retryHistory[qIndex].map(correct => 
            correct ? 'âœ…' : 'âŒ'
          ).join(' ');
          historyHTML = `<p><strong>å¾©ç¿’å±¥æ­´:</strong> ${historyIcons}</p>`;
        }
        
        html += `
          <div class="result-card" id="result-q-${qIndex+1}">
            <h3>å•é¡Œ ${qIndex+1}</h3>
            <p class="result-status ${ok ? 'correct':'incorrect'}">${ok ? 'âœ… æ­£è§£':'âŒ ä¸æ­£è§£'}</p>
            ${historyHTML}
            <p><strong>è³ªå•:</strong> ${q.question}</p>
            <p><strong>ã‚ãªãŸã®å›ç­”:</strong> ${ua !== null ? q.options[ua] : 'æœªå›ç­”'}</p>
            <p><strong>æ­£è§£:</strong> ${q.options[q.answer]}</p>
            <p><strong>èª¬æ˜:</strong> ${q.explanation}</p>
          </div>
        `;
      });

      html += `<button class="nav-button" onclick="restartQuiz()">ğŸ”„ å…¨å•é¡Œã‚’ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>`;
      $('result-container').innerHTML = html;

      if(pct === 100 && !isRetryMode){
        const a = $('attendance-link');
        a.style.display = 'block';
        a.innerHTML = `<p>ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å…¨å•æ­£è§£ã§ã™ã€‚</p>
          <a href="https://forms.gle/DeQdbX2q1uujUBmFA" target="_blank" rel="noopener">å‡ºå¸­ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ ã«å›ç­”ã™ã‚‹</a>`;
      }
    }

    window.restartQuiz = function(){
      $('quiz-container').style.display = 'block';
      $('result-container').innerHTML = '';
      $('attendance-link').style.display = 'none';
      initQuiz(false);
    };

    window.retryWrongQuestions = function(){
      if(wrongQuestions.length === 0){
        alert('é–“é•ãˆãŸå•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“ï¼');
        return;
      }
      $('quiz-container').style.display = 'block';
      $('result-container').innerHTML = '';
      $('attendance-link').style.display = 'none';
      initQuiz(true, wrongQuestions);
    };

    // èµ·å‹•
    initQuiz();
  </script>
</body>
</html>
